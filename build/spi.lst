ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"spi.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.MX_SPI1_Init,"ax",%progbits
  18              		.align	1
  19              		.global	MX_SPI1_Init
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	MX_SPI1_Init:
  26              	.LFB126:
  27              		.file 1 "Src/spi.c"
   1:Src/spi.c     **** /**
   2:Src/spi.c     ****   ******************************************************************************
   3:Src/spi.c     ****   * File Name          : SPI.c
   4:Src/spi.c     ****   * Description        : This file provides code for the configuration
   5:Src/spi.c     ****   *                      of the SPI instances.
   6:Src/spi.c     ****   ******************************************************************************
   7:Src/spi.c     ****   ** This notice applies to any and all portions of this file
   8:Src/spi.c     ****   * that are not between comment pairs USER CODE BEGIN and
   9:Src/spi.c     ****   * USER CODE END. Other portions of this file, whether 
  10:Src/spi.c     ****   * inserted by the user or by software development tools
  11:Src/spi.c     ****   * are owned by their respective copyright owners.
  12:Src/spi.c     ****   *
  13:Src/spi.c     ****   * COPYRIGHT(c) 2021 STMicroelectronics
  14:Src/spi.c     ****   *
  15:Src/spi.c     ****   * Redistribution and use in source and binary forms, with or without modification,
  16:Src/spi.c     ****   * are permitted provided that the following conditions are met:
  17:Src/spi.c     ****   *   1. Redistributions of source code must retain the above copyright notice,
  18:Src/spi.c     ****   *      this list of conditions and the following disclaimer.
  19:Src/spi.c     ****   *   2. Redistributions in binary form must reproduce the above copyright notice,
  20:Src/spi.c     ****   *      this list of conditions and the following disclaimer in the documentation
  21:Src/spi.c     ****   *      and/or other materials provided with the distribution.
  22:Src/spi.c     ****   *   3. Neither the name of STMicroelectronics nor the names of its contributors
  23:Src/spi.c     ****   *      may be used to endorse or promote products derived from this software
  24:Src/spi.c     ****   *      without specific prior written permission.
  25:Src/spi.c     ****   *
  26:Src/spi.c     ****   * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  27:Src/spi.c     ****   * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  28:Src/spi.c     ****   * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  29:Src/spi.c     ****   * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  30:Src/spi.c     ****   * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  31:Src/spi.c     ****   * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 2


  32:Src/spi.c     ****   * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  33:Src/spi.c     ****   * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  34:Src/spi.c     ****   * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  35:Src/spi.c     ****   * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  36:Src/spi.c     ****   *
  37:Src/spi.c     ****   ******************************************************************************
  38:Src/spi.c     ****   */
  39:Src/spi.c     **** 
  40:Src/spi.c     **** /* Includes ------------------------------------------------------------------*/
  41:Src/spi.c     **** #include "spi.h"
  42:Src/spi.c     **** 
  43:Src/spi.c     **** #include "gpio.h"
  44:Src/spi.c     **** 
  45:Src/spi.c     **** /* USER CODE BEGIN 0 */
  46:Src/spi.c     **** #include "variable.h"
  47:Src/spi.c     **** // MPU6500ã?????????��?��??��?��???��?��??��?��????��?��??
  48:Src/spi.c     **** #define MPU6500_RA_SELF_TEST_X_GYRO	0x00
  49:Src/spi.c     **** #define MPU6500_RA_SELF_TEST_Y_GYRO	0x01
  50:Src/spi.c     **** #define MPU6500_RA_SELF_TEST_Z_GYRO	0x02
  51:Src/spi.c     **** #define MPU6500_RA_SELF_TEST_X_ACCEL	0x0D
  52:Src/spi.c     **** #define MPU6500_RA_SELF_TEST_Y_ACCEL	0x0E
  53:Src/spi.c     **** #define MPU6500_RA_SELF_TEST_Z_ACCEL	0x0F
  54:Src/spi.c     **** #define MPU6500_RA_XG_OFFSET_H		0x13
  55:Src/spi.c     **** #define MPU6500_RA_XG_OFFSET_L		0x14
  56:Src/spi.c     **** #define MPU6500_RA_YG_OFFSET_H		0x15
  57:Src/spi.c     **** #define MPU6500_RA_YG_OFFSET_L		0x16
  58:Src/spi.c     **** #define MPU6500_RA_ZG_OFFSET_H		0x17
  59:Src/spi.c     **** #define MPU6500_RA_ZG_OFFSET_L		0x18
  60:Src/spi.c     **** #define MPU6500_RA_SMPLRT_DIV		0x19
  61:Src/spi.c     **** #define MPU6500_RA_CONFIG			0x1A
  62:Src/spi.c     **** #define MPU6500_RA_GYRO_CONFIG		0x1B
  63:Src/spi.c     **** #define MPU6500_RA_ACCEL_CONFIG		0x1C
  64:Src/spi.c     **** #define MPU6500_RA_ACCEL_CONFIG2	0x1D
  65:Src/spi.c     **** #define MPU6500_RA_LP_ACCEL_ODR		0x1E
  66:Src/spi.c     **** #define MPU6500_RA_WOM_THR			0x1F
  67:Src/spi.c     **** #define MPU6500_RA_FIFO_EN			0x23
  68:Src/spi.c     **** // ...
  69:Src/spi.c     **** // å¤–éƒ¨I2Cå‘¨ã‚�?ï¿½????¿½?¿½??¿½?¿½çœ�?ç•¥
  70:Src/spi.c     **** // ...
  71:Src/spi.c     **** #define MPU6500_RA_INT_PIN_CFG		0x37
  72:Src/spi.c     **** #define MPU6500_RA_INT_ENABLE		0x38
  73:Src/spi.c     **** #define MPU6500_RA_INT_STATUS		0x3A
  74:Src/spi.c     **** #define MPU6500_RA_ACCEL_XOUT_H		0x3B
  75:Src/spi.c     **** #define MPU6500_RA_ACCEL_XOUT_L		0x3C
  76:Src/spi.c     **** #define MPU6500_RA_ACCEL_YOUT_H		0x3D
  77:Src/spi.c     **** #define MPU6500_RA_ACCEL_YOUT_L		0x3E
  78:Src/spi.c     **** #define MPU6500_RA_ACCEL_ZOUT_H		0x3F
  79:Src/spi.c     **** #define MPU6500_RA_ACCEL_ZOUT_L		0x40
  80:Src/spi.c     **** #define MPU6500_RA_TEMP_OUT_H		0x41
  81:Src/spi.c     **** #define MPU6500_RA_TEMP_OUT_L		0x42
  82:Src/spi.c     **** #define MPU6500_RA_GYRO_XOUT_H		0x43
  83:Src/spi.c     **** #define MPU6500_RA_GYRO_XOUT_L		0x44
  84:Src/spi.c     **** #define MPU6500_RA_GYRO_YOUT_H		0x45
  85:Src/spi.c     **** #define MPU6500_RA_GYRO_YOUT_L		0x46
  86:Src/spi.c     **** #define MPU6500_RA_GYRO_ZOUT_H		0x47
  87:Src/spi.c     **** #define MPU6500_RA_GYRO_ZOUT_L		0x48
  88:Src/spi.c     **** // ...
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 3


  89:Src/spi.c     **** // å¤–éƒ¨I2Cå‘¨ã‚�?ï¿½????¿½?¿½??¿½?¿½çœ�?ç•¥
  90:Src/spi.c     **** // ...
  91:Src/spi.c     **** #define MPU6500_RA_SIGNAL_PATH_RESET	0x68
  92:Src/spi.c     **** #define MPU6500_RA_MOT_DETECT_CTRL		0x69
  93:Src/spi.c     **** #define MPU6500_RA_USER_CTRL		0x6A
  94:Src/spi.c     **** #define MPU6500_RA_PWR_MGMT_1		0x6B
  95:Src/spi.c     **** #define MPU6500_RA_PWR_MGMT_2		0x6C
  96:Src/spi.c     **** #define MPU6500_RA_FIFO_COUNTH		0x72
  97:Src/spi.c     **** #define MPU6500_RA_FIFO_COUNTL			0x73
  98:Src/spi.c     **** #define MPU6500_RA_FIFO_R_W			0x74
  99:Src/spi.c     **** #define MPU6500_RA_WHO_AM_I			0x75
 100:Src/spi.c     **** #define MPU6500_RA_XA_OFFSET_H		0x77
 101:Src/spi.c     **** #define MPU6500_RA_XA_OFFSET_L		0x78
 102:Src/spi.c     **** #define MPU6500_RA_YA_OFFSET_H		0x7A
 103:Src/spi.c     **** #define MPU6500_RA_YA_OFFSET_L		0x7B
 104:Src/spi.c     **** #define MPU6500_RA_ZA_OFFSET_H		0x7D
 105:Src/spi.c     **** #define MPU6500_RA_ZA_OFFSET_L		0x7E
 106:Src/spi.c     **** 
 107:Src/spi.c     **** #define MPU6500_DEVICE_ID			0x70
 108:Src/spi.c     **** 
 109:Src/spi.c     **** #define SETTING       0x80  //0b1000 0000 8bitの上位bitを立てると
 110:Src/spi.c     **** 
 111:Src/spi.c     **** // ã‚¸ãƒ£ã‚¤ãƒ­ã?????????��?��??��?��???��?��??��?��
 112:Src/spi.c     **** #define GYRO_FACTOR  16.4f
 113:Src/spi.c     **** 
 114:Src/spi.c     **** #define ACCEL_FACTOR 2048.0f
 115:Src/spi.c     **** 
 116:Src/spi.c     **** #define ANGLECOM 0x3fff
 117:Src/spi.c     **** #define ANGLEUNC 0x7ffe
 118:Src/spi.c     **** #define ZPOSM 0x0016
 119:Src/spi.c     **** #define ZPOSL 0x0017
 120:Src/spi.c     **** #define SETTINGS1 0x0018
 121:Src/spi.c     **** #define SETTINGS2 0x0019
 122:Src/spi.c     **** 
 123:Src/spi.c     **** #define TRUE 0
 124:Src/spi.c     **** #define FALSE 1
 125:Src/spi.c     **** 
 126:Src/spi.c     **** #define dt 0.001f
 127:Src/spi.c     **** 
 128:Src/spi.c     **** static int16_t gyro_offset_cnt = 0; 
 129:Src/spi.c     **** static int8_t  gyro_calc_flag = 1;
 130:Src/spi.c     **** static float gyro_z_offset = 0.0f;
 131:Src/spi.c     **** 
 132:Src/spi.c     **** /* USER CODE END 0 */
 133:Src/spi.c     **** 
 134:Src/spi.c     **** SPI_HandleTypeDef hspi1;
 135:Src/spi.c     **** SPI_HandleTypeDef hspi2;
 136:Src/spi.c     **** 
 137:Src/spi.c     **** /* SPI1 init function */
 138:Src/spi.c     **** void MX_SPI1_Init(void)
 139:Src/spi.c     **** {
  28              		.loc 1 139 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32 0000 08B5     		push	{r3, lr}
  33              	.LCFI0:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 4


  34              		.cfi_def_cfa_offset 8
  35              		.cfi_offset 3, -8
  36              		.cfi_offset 14, -4
 140:Src/spi.c     **** 
 141:Src/spi.c     ****   hspi1.Instance = SPI1;
  37              		.loc 1 141 0
  38 0002 1048     		ldr	r0, .L5
  39 0004 104B     		ldr	r3, .L5+4
  40 0006 0360     		str	r3, [r0]
 142:Src/spi.c     ****   hspi1.Init.Mode = SPI_MODE_MASTER;
  41              		.loc 1 142 0
  42 0008 4FF48273 		mov	r3, #260
  43 000c 4360     		str	r3, [r0, #4]
 143:Src/spi.c     ****   hspi1.Init.Direction = SPI_DIRECTION_2LINES;
  44              		.loc 1 143 0
  45 000e 0023     		movs	r3, #0
  46 0010 8360     		str	r3, [r0, #8]
 144:Src/spi.c     ****   hspi1.Init.DataSize = SPI_DATASIZE_16BIT;
  47              		.loc 1 144 0
  48 0012 4FF40062 		mov	r2, #2048
  49 0016 C260     		str	r2, [r0, #12]
 145:Src/spi.c     ****   hspi1.Init.CLKPolarity = SPI_POLARITY_LOW;
  50              		.loc 1 145 0
  51 0018 0361     		str	r3, [r0, #16]
 146:Src/spi.c     ****   hspi1.Init.CLKPhase = SPI_PHASE_2EDGE;
  52              		.loc 1 146 0
  53 001a 0122     		movs	r2, #1
  54 001c 4261     		str	r2, [r0, #20]
 147:Src/spi.c     ****   hspi1.Init.NSS = SPI_NSS_SOFT;
  55              		.loc 1 147 0
  56 001e 4FF40072 		mov	r2, #512
  57 0022 8261     		str	r2, [r0, #24]
 148:Src/spi.c     ****   hspi1.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_8;
  58              		.loc 1 148 0
  59 0024 1022     		movs	r2, #16
  60 0026 C261     		str	r2, [r0, #28]
 149:Src/spi.c     ****   hspi1.Init.FirstBit = SPI_FIRSTBIT_MSB;
  61              		.loc 1 149 0
  62 0028 0362     		str	r3, [r0, #32]
 150:Src/spi.c     ****   hspi1.Init.TIMode = SPI_TIMODE_DISABLE;
  63              		.loc 1 150 0
  64 002a 4362     		str	r3, [r0, #36]
 151:Src/spi.c     ****   hspi1.Init.CRCCalculation = SPI_CRCCALCULATION_DISABLE;
  65              		.loc 1 151 0
  66 002c 8362     		str	r3, [r0, #40]
 152:Src/spi.c     ****   hspi1.Init.CRCPolynomial = 10;
  67              		.loc 1 152 0
  68 002e 0A23     		movs	r3, #10
  69 0030 C362     		str	r3, [r0, #44]
 153:Src/spi.c     ****   if (HAL_SPI_Init(&hspi1) != HAL_OK)
  70              		.loc 1 153 0
  71 0032 FFF7FEFF 		bl	HAL_SPI_Init
  72              	.LVL0:
  73 0036 00B9     		cbnz	r0, .L4
  74              	.L1:
 154:Src/spi.c     ****   {
 155:Src/spi.c     ****     _Error_Handler(__FILE__, __LINE__);
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 5


 156:Src/spi.c     ****   }
 157:Src/spi.c     **** 
 158:Src/spi.c     **** }
  75              		.loc 1 158 0
  76 0038 08BD     		pop	{r3, pc}
  77              	.L4:
 155:Src/spi.c     ****   }
  78              		.loc 1 155 0
  79 003a 9B21     		movs	r1, #155
  80 003c 0348     		ldr	r0, .L5+8
  81 003e FFF7FEFF 		bl	_Error_Handler
  82              	.LVL1:
  83              		.loc 1 158 0
  84 0042 F9E7     		b	.L1
  85              	.L6:
  86              		.align	2
  87              	.L5:
  88 0044 00000000 		.word	hspi1
  89 0048 00300140 		.word	1073819648
  90 004c 00000000 		.word	.LC0
  91              		.cfi_endproc
  92              	.LFE126:
  94              		.section	.text.MX_SPI2_Init,"ax",%progbits
  95              		.align	1
  96              		.global	MX_SPI2_Init
  97              		.syntax unified
  98              		.thumb
  99              		.thumb_func
 100              		.fpu fpv4-sp-d16
 102              	MX_SPI2_Init:
 103              	.LFB127:
 159:Src/spi.c     **** /* SPI2 init function */
 160:Src/spi.c     **** void MX_SPI2_Init(void)
 161:Src/spi.c     **** {
 104              		.loc 1 161 0
 105              		.cfi_startproc
 106              		@ args = 0, pretend = 0, frame = 0
 107              		@ frame_needed = 0, uses_anonymous_args = 0
 108 0000 08B5     		push	{r3, lr}
 109              	.LCFI1:
 110              		.cfi_def_cfa_offset 8
 111              		.cfi_offset 3, -8
 112              		.cfi_offset 14, -4
 162:Src/spi.c     **** 
 163:Src/spi.c     ****   hspi2.Instance = SPI2;
 113              		.loc 1 163 0
 114 0002 1048     		ldr	r0, .L11
 115 0004 104B     		ldr	r3, .L11+4
 116 0006 0360     		str	r3, [r0]
 164:Src/spi.c     ****   hspi2.Init.Mode = SPI_MODE_MASTER;
 117              		.loc 1 164 0
 118 0008 4FF48273 		mov	r3, #260
 119 000c 4360     		str	r3, [r0, #4]
 165:Src/spi.c     ****   hspi2.Init.Direction = SPI_DIRECTION_2LINES;
 120              		.loc 1 165 0
 121 000e 0023     		movs	r3, #0
 122 0010 8360     		str	r3, [r0, #8]
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 6


 166:Src/spi.c     ****   hspi2.Init.DataSize = SPI_DATASIZE_8BIT;
 123              		.loc 1 166 0
 124 0012 C360     		str	r3, [r0, #12]
 167:Src/spi.c     ****   hspi2.Init.CLKPolarity = SPI_POLARITY_HIGH;
 125              		.loc 1 167 0
 126 0014 0222     		movs	r2, #2
 127 0016 0261     		str	r2, [r0, #16]
 168:Src/spi.c     ****   hspi2.Init.CLKPhase = SPI_PHASE_2EDGE;
 128              		.loc 1 168 0
 129 0018 0122     		movs	r2, #1
 130 001a 4261     		str	r2, [r0, #20]
 169:Src/spi.c     ****   hspi2.Init.NSS = SPI_NSS_SOFT;
 131              		.loc 1 169 0
 132 001c 4FF40072 		mov	r2, #512
 133 0020 8261     		str	r2, [r0, #24]
 170:Src/spi.c     ****   hspi2.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_4;
 134              		.loc 1 170 0
 135 0022 0822     		movs	r2, #8
 136 0024 C261     		str	r2, [r0, #28]
 171:Src/spi.c     ****   hspi2.Init.FirstBit = SPI_FIRSTBIT_MSB;
 137              		.loc 1 171 0
 138 0026 0362     		str	r3, [r0, #32]
 172:Src/spi.c     ****   hspi2.Init.TIMode = SPI_TIMODE_DISABLE;
 139              		.loc 1 172 0
 140 0028 4362     		str	r3, [r0, #36]
 173:Src/spi.c     ****   hspi2.Init.CRCCalculation = SPI_CRCCALCULATION_DISABLE;
 141              		.loc 1 173 0
 142 002a 8362     		str	r3, [r0, #40]
 174:Src/spi.c     ****   hspi2.Init.CRCPolynomial = 10;
 143              		.loc 1 174 0
 144 002c 0A23     		movs	r3, #10
 145 002e C362     		str	r3, [r0, #44]
 175:Src/spi.c     ****   if (HAL_SPI_Init(&hspi2) != HAL_OK)
 146              		.loc 1 175 0
 147 0030 FFF7FEFF 		bl	HAL_SPI_Init
 148              	.LVL2:
 149 0034 00B9     		cbnz	r0, .L10
 150              	.L7:
 176:Src/spi.c     ****   {
 177:Src/spi.c     ****     _Error_Handler(__FILE__, __LINE__);
 178:Src/spi.c     ****   }
 179:Src/spi.c     **** 
 180:Src/spi.c     **** }
 151              		.loc 1 180 0
 152 0036 08BD     		pop	{r3, pc}
 153              	.L10:
 177:Src/spi.c     ****   }
 154              		.loc 1 177 0
 155 0038 B121     		movs	r1, #177
 156 003a 0448     		ldr	r0, .L11+8
 157 003c FFF7FEFF 		bl	_Error_Handler
 158              	.LVL3:
 159              		.loc 1 180 0
 160 0040 F9E7     		b	.L7
 161              	.L12:
 162 0042 00BF     		.align	2
 163              	.L11:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 7


 164 0044 00000000 		.word	hspi2
 165 0048 00380040 		.word	1073756160
 166 004c 00000000 		.word	.LC0
 167              		.cfi_endproc
 168              	.LFE127:
 170              		.section	.text.HAL_SPI_MspInit,"ax",%progbits
 171              		.align	1
 172              		.global	HAL_SPI_MspInit
 173              		.syntax unified
 174              		.thumb
 175              		.thumb_func
 176              		.fpu fpv4-sp-d16
 178              	HAL_SPI_MspInit:
 179              	.LFB128:
 181:Src/spi.c     **** 
 182:Src/spi.c     **** void HAL_SPI_MspInit(SPI_HandleTypeDef* spiHandle)
 183:Src/spi.c     **** {
 180              		.loc 1 183 0
 181              		.cfi_startproc
 182              		@ args = 0, pretend = 0, frame = 32
 183              		@ frame_needed = 0, uses_anonymous_args = 0
 184              	.LVL4:
 185 0000 00B5     		push	{lr}
 186              	.LCFI2:
 187              		.cfi_def_cfa_offset 4
 188              		.cfi_offset 14, -4
 189 0002 89B0     		sub	sp, sp, #36
 190              	.LCFI3:
 191              		.cfi_def_cfa_offset 40
 184:Src/spi.c     **** 
 185:Src/spi.c     ****   GPIO_InitTypeDef GPIO_InitStruct;
 186:Src/spi.c     ****   if(spiHandle->Instance==SPI1)
 192              		.loc 1 186 0
 193 0004 0368     		ldr	r3, [r0]
 194 0006 1F4A     		ldr	r2, .L19
 195 0008 9342     		cmp	r3, r2
 196 000a 05D0     		beq	.L17
 187:Src/spi.c     ****   {
 188:Src/spi.c     ****   /* USER CODE BEGIN SPI1_MspInit 0 */
 189:Src/spi.c     **** 
 190:Src/spi.c     ****   /* USER CODE END SPI1_MspInit 0 */
 191:Src/spi.c     ****     /* SPI1 clock enable */
 192:Src/spi.c     ****     __HAL_RCC_SPI1_CLK_ENABLE();
 193:Src/spi.c     ****   
 194:Src/spi.c     ****     /**SPI1 GPIO Configuration    
 195:Src/spi.c     ****     PA5     ------> SPI1_SCK
 196:Src/spi.c     ****     PA6     ------> SPI1_MISO
 197:Src/spi.c     ****     PA7     ------> SPI1_MOSI 
 198:Src/spi.c     ****     */
 199:Src/spi.c     ****     GPIO_InitStruct.Pin = GPIO_PIN_5|GPIO_PIN_6|GPIO_PIN_7;
 200:Src/spi.c     ****     GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
 201:Src/spi.c     ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 202:Src/spi.c     ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
 203:Src/spi.c     ****     GPIO_InitStruct.Alternate = GPIO_AF5_SPI1;
 204:Src/spi.c     ****     HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);
 205:Src/spi.c     **** 
 206:Src/spi.c     ****   /* USER CODE BEGIN SPI1_MspInit 1 */
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 8


 207:Src/spi.c     **** 
 208:Src/spi.c     ****   /* USER CODE END SPI1_MspInit 1 */
 209:Src/spi.c     ****   }
 210:Src/spi.c     ****   else if(spiHandle->Instance==SPI2)
 197              		.loc 1 210 0
 198 000c 1E4A     		ldr	r2, .L19+4
 199 000e 9342     		cmp	r3, r2
 200 0010 1CD0     		beq	.L18
 201              	.LVL5:
 202              	.L13:
 211:Src/spi.c     ****   {
 212:Src/spi.c     ****   /* USER CODE BEGIN SPI2_MspInit 0 */
 213:Src/spi.c     **** 
 214:Src/spi.c     ****   /* USER CODE END SPI2_MspInit 0 */
 215:Src/spi.c     ****     /* SPI2 clock enable */
 216:Src/spi.c     ****     __HAL_RCC_SPI2_CLK_ENABLE();
 217:Src/spi.c     ****   
 218:Src/spi.c     ****     /**SPI2 GPIO Configuration    
 219:Src/spi.c     ****     PB10     ------> SPI2_SCK
 220:Src/spi.c     ****     PB14     ------> SPI2_MISO
 221:Src/spi.c     ****     PB15     ------> SPI2_MOSI 
 222:Src/spi.c     ****     */
 223:Src/spi.c     ****     GPIO_InitStruct.Pin = GPIO_PIN_10|GPIO_PIN_14|GPIO_PIN_15;
 224:Src/spi.c     ****     GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
 225:Src/spi.c     ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 226:Src/spi.c     ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
 227:Src/spi.c     ****     GPIO_InitStruct.Alternate = GPIO_AF5_SPI2;
 228:Src/spi.c     ****     HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);
 229:Src/spi.c     **** 
 230:Src/spi.c     ****   /* USER CODE BEGIN SPI2_MspInit 1 */
 231:Src/spi.c     **** 
 232:Src/spi.c     ****   /* USER CODE END SPI2_MspInit 1 */
 233:Src/spi.c     ****   }
 234:Src/spi.c     **** }
 203              		.loc 1 234 0
 204 0012 09B0     		add	sp, sp, #36
 205              	.LCFI4:
 206              		.cfi_remember_state
 207              		.cfi_def_cfa_offset 4
 208              		@ sp needed
 209 0014 5DF804FB 		ldr	pc, [sp], #4
 210              	.LVL6:
 211              	.L17:
 212              	.LCFI5:
 213              		.cfi_restore_state
 214              	.LBB2:
 192:Src/spi.c     ****   
 215              		.loc 1 192 0
 216 0018 0021     		movs	r1, #0
 217 001a 0191     		str	r1, [sp, #4]
 218 001c 1B4B     		ldr	r3, .L19+8
 219 001e 5A6C     		ldr	r2, [r3, #68]
 220 0020 42F48052 		orr	r2, r2, #4096
 221 0024 5A64     		str	r2, [r3, #68]
 222 0026 5B6C     		ldr	r3, [r3, #68]
 223 0028 03F48053 		and	r3, r3, #4096
 224 002c 0193     		str	r3, [sp, #4]
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 9


 225 002e 019B     		ldr	r3, [sp, #4]
 226              	.LBE2:
 199:Src/spi.c     ****     GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
 227              		.loc 1 199 0
 228 0030 E023     		movs	r3, #224
 229 0032 0393     		str	r3, [sp, #12]
 200:Src/spi.c     ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 230              		.loc 1 200 0
 231 0034 0223     		movs	r3, #2
 232 0036 0493     		str	r3, [sp, #16]
 201:Src/spi.c     ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
 233              		.loc 1 201 0
 234 0038 0591     		str	r1, [sp, #20]
 202:Src/spi.c     ****     GPIO_InitStruct.Alternate = GPIO_AF5_SPI1;
 235              		.loc 1 202 0
 236 003a 0323     		movs	r3, #3
 237 003c 0693     		str	r3, [sp, #24]
 203:Src/spi.c     ****     HAL_GPIO_Init(GPIOA, &GPIO_InitStruct);
 238              		.loc 1 203 0
 239 003e 0523     		movs	r3, #5
 240 0040 0793     		str	r3, [sp, #28]
 204:Src/spi.c     **** 
 241              		.loc 1 204 0
 242 0042 03A9     		add	r1, sp, #12
 243 0044 1248     		ldr	r0, .L19+12
 244              	.LVL7:
 245 0046 FFF7FEFF 		bl	HAL_GPIO_Init
 246              	.LVL8:
 247 004a E2E7     		b	.L13
 248              	.LVL9:
 249              	.L18:
 250              	.LBB3:
 216:Src/spi.c     ****   
 251              		.loc 1 216 0
 252 004c 0021     		movs	r1, #0
 253 004e 0291     		str	r1, [sp, #8]
 254 0050 0E4B     		ldr	r3, .L19+8
 255 0052 1A6C     		ldr	r2, [r3, #64]
 256 0054 42F48042 		orr	r2, r2, #16384
 257 0058 1A64     		str	r2, [r3, #64]
 258 005a 1B6C     		ldr	r3, [r3, #64]
 259 005c 03F48043 		and	r3, r3, #16384
 260 0060 0293     		str	r3, [sp, #8]
 261 0062 029B     		ldr	r3, [sp, #8]
 262              	.LBE3:
 223:Src/spi.c     ****     GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
 263              		.loc 1 223 0
 264 0064 4FF44443 		mov	r3, #50176
 265 0068 0393     		str	r3, [sp, #12]
 224:Src/spi.c     ****     GPIO_InitStruct.Pull = GPIO_NOPULL;
 266              		.loc 1 224 0
 267 006a 0223     		movs	r3, #2
 268 006c 0493     		str	r3, [sp, #16]
 225:Src/spi.c     ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;
 269              		.loc 1 225 0
 270 006e 0591     		str	r1, [sp, #20]
 226:Src/spi.c     ****     GPIO_InitStruct.Alternate = GPIO_AF5_SPI2;
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 10


 271              		.loc 1 226 0
 272 0070 0323     		movs	r3, #3
 273 0072 0693     		str	r3, [sp, #24]
 227:Src/spi.c     ****     HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);
 274              		.loc 1 227 0
 275 0074 0523     		movs	r3, #5
 276 0076 0793     		str	r3, [sp, #28]
 228:Src/spi.c     **** 
 277              		.loc 1 228 0
 278 0078 03A9     		add	r1, sp, #12
 279 007a 0648     		ldr	r0, .L19+16
 280              	.LVL10:
 281 007c FFF7FEFF 		bl	HAL_GPIO_Init
 282              	.LVL11:
 283              		.loc 1 234 0
 284 0080 C7E7     		b	.L13
 285              	.L20:
 286 0082 00BF     		.align	2
 287              	.L19:
 288 0084 00300140 		.word	1073819648
 289 0088 00380040 		.word	1073756160
 290 008c 00380240 		.word	1073887232
 291 0090 00000240 		.word	1073872896
 292 0094 00040240 		.word	1073873920
 293              		.cfi_endproc
 294              	.LFE128:
 296              		.section	.text.HAL_SPI_MspDeInit,"ax",%progbits
 297              		.align	1
 298              		.global	HAL_SPI_MspDeInit
 299              		.syntax unified
 300              		.thumb
 301              		.thumb_func
 302              		.fpu fpv4-sp-d16
 304              	HAL_SPI_MspDeInit:
 305              	.LFB129:
 235:Src/spi.c     **** 
 236:Src/spi.c     **** void HAL_SPI_MspDeInit(SPI_HandleTypeDef* spiHandle)
 237:Src/spi.c     **** {
 306              		.loc 1 237 0
 307              		.cfi_startproc
 308              		@ args = 0, pretend = 0, frame = 0
 309              		@ frame_needed = 0, uses_anonymous_args = 0
 310              	.LVL12:
 311 0000 08B5     		push	{r3, lr}
 312              	.LCFI6:
 313              		.cfi_def_cfa_offset 8
 314              		.cfi_offset 3, -8
 315              		.cfi_offset 14, -4
 238:Src/spi.c     **** 
 239:Src/spi.c     ****   if(spiHandle->Instance==SPI1)
 316              		.loc 1 239 0
 317 0002 0368     		ldr	r3, [r0]
 318 0004 0E4A     		ldr	r2, .L27
 319 0006 9342     		cmp	r3, r2
 320 0008 03D0     		beq	.L25
 240:Src/spi.c     ****   {
 241:Src/spi.c     ****   /* USER CODE BEGIN SPI1_MspDeInit 0 */
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 11


 242:Src/spi.c     **** 
 243:Src/spi.c     ****   /* USER CODE END SPI1_MspDeInit 0 */
 244:Src/spi.c     ****     /* Peripheral clock disable */
 245:Src/spi.c     ****     __HAL_RCC_SPI1_CLK_DISABLE();
 246:Src/spi.c     ****   
 247:Src/spi.c     ****     /**SPI1 GPIO Configuration    
 248:Src/spi.c     ****     PA5     ------> SPI1_SCK
 249:Src/spi.c     ****     PA6     ------> SPI1_MISO
 250:Src/spi.c     ****     PA7     ------> SPI1_MOSI 
 251:Src/spi.c     ****     */
 252:Src/spi.c     ****     HAL_GPIO_DeInit(GPIOA, GPIO_PIN_5|GPIO_PIN_6|GPIO_PIN_7);
 253:Src/spi.c     **** 
 254:Src/spi.c     ****   /* USER CODE BEGIN SPI1_MspDeInit 1 */
 255:Src/spi.c     **** 
 256:Src/spi.c     ****   /* USER CODE END SPI1_MspDeInit 1 */
 257:Src/spi.c     ****   }
 258:Src/spi.c     ****   else if(spiHandle->Instance==SPI2)
 321              		.loc 1 258 0
 322 000a 0E4A     		ldr	r2, .L27+4
 323 000c 9342     		cmp	r3, r2
 324 000e 0BD0     		beq	.L26
 325              	.LVL13:
 326              	.L21:
 259:Src/spi.c     ****   {
 260:Src/spi.c     ****   /* USER CODE BEGIN SPI2_MspDeInit 0 */
 261:Src/spi.c     **** 
 262:Src/spi.c     ****   /* USER CODE END SPI2_MspDeInit 0 */
 263:Src/spi.c     ****     /* Peripheral clock disable */
 264:Src/spi.c     ****     __HAL_RCC_SPI2_CLK_DISABLE();
 265:Src/spi.c     ****   
 266:Src/spi.c     ****     /**SPI2 GPIO Configuration    
 267:Src/spi.c     ****     PB10     ------> SPI2_SCK
 268:Src/spi.c     ****     PB14     ------> SPI2_MISO
 269:Src/spi.c     ****     PB15     ------> SPI2_MOSI 
 270:Src/spi.c     ****     */
 271:Src/spi.c     ****     HAL_GPIO_DeInit(GPIOB, GPIO_PIN_10|GPIO_PIN_14|GPIO_PIN_15);
 272:Src/spi.c     **** 
 273:Src/spi.c     ****   /* USER CODE BEGIN SPI2_MspDeInit 1 */
 274:Src/spi.c     **** 
 275:Src/spi.c     ****   /* USER CODE END SPI2_MspDeInit 1 */
 276:Src/spi.c     ****   }
 277:Src/spi.c     **** } 
 327              		.loc 1 277 0
 328 0010 08BD     		pop	{r3, pc}
 329              	.LVL14:
 330              	.L25:
 245:Src/spi.c     ****   
 331              		.loc 1 245 0
 332 0012 02F58432 		add	r2, r2, #67584
 333 0016 536C     		ldr	r3, [r2, #68]
 334 0018 23F48053 		bic	r3, r3, #4096
 335 001c 5364     		str	r3, [r2, #68]
 252:Src/spi.c     **** 
 336              		.loc 1 252 0
 337 001e E021     		movs	r1, #224
 338 0020 0948     		ldr	r0, .L27+8
 339              	.LVL15:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 12


 340 0022 FFF7FEFF 		bl	HAL_GPIO_DeInit
 341              	.LVL16:
 342 0026 F3E7     		b	.L21
 343              	.LVL17:
 344              	.L26:
 264:Src/spi.c     ****   
 345              		.loc 1 264 0
 346 0028 02F50032 		add	r2, r2, #131072
 347 002c 136C     		ldr	r3, [r2, #64]
 348 002e 23F48043 		bic	r3, r3, #16384
 349 0032 1364     		str	r3, [r2, #64]
 271:Src/spi.c     **** 
 350              		.loc 1 271 0
 351 0034 4FF44441 		mov	r1, #50176
 352 0038 0448     		ldr	r0, .L27+12
 353              	.LVL18:
 354 003a FFF7FEFF 		bl	HAL_GPIO_DeInit
 355              	.LVL19:
 356              		.loc 1 277 0
 357 003e E7E7     		b	.L21
 358              	.L28:
 359              		.align	2
 360              	.L27:
 361 0040 00300140 		.word	1073819648
 362 0044 00380040 		.word	1073756160
 363 0048 00000240 		.word	1073872896
 364 004c 00040240 		.word	1073873920
 365              		.cfi_endproc
 366              	.LFE129:
 368              		.section	.text.read_byte,"ax",%progbits
 369              		.align	1
 370              		.global	read_byte
 371              		.syntax unified
 372              		.thumb
 373              		.thumb_func
 374              		.fpu fpv4-sp-d16
 376              	read_byte:
 377              	.LFB130:
 278:Src/spi.c     **** 
 279:Src/spi.c     **** /* USER CODE BEGIN 1 */
 280:Src/spi.c     **** /********************************************************************
 281:Src/spi.c     ****  * Overview : spi read register
 282:Src/spi.c     ****  * Argument : register
 283:Src/spi.c     ****  * Return : 1byte data
 284:Src/spi.c     **** ********************************************************************/
 285:Src/spi.c     **** uint8_t read_byte(uint8_t reg){
 378              		.loc 1 285 0
 379              		.cfi_startproc
 380              		@ args = 0, pretend = 0, frame = 8
 381              		@ frame_needed = 0, uses_anonymous_args = 0
 382              	.LVL20:
 383 0000 30B5     		push	{r4, r5, lr}
 384              	.LCFI7:
 385              		.cfi_def_cfa_offset 12
 386              		.cfi_offset 4, -12
 387              		.cfi_offset 5, -8
 388              		.cfi_offset 14, -4
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 13


 389 0002 83B0     		sub	sp, sp, #12
 390              	.LCFI8:
 391              		.cfi_def_cfa_offset 24
 392 0004 0446     		mov	r4, r0
 286:Src/spi.c     ****   uint8_t ret,val;
 287:Src/spi.c     ****   HAL_GPIO_WritePin(gyro_cs_GPIO_Port,gyro_cs_Pin,GPIO_PIN_RESET);
 393              		.loc 1 287 0
 394 0006 114D     		ldr	r5, .L31
 395 0008 0022     		movs	r2, #0
 396 000a 4FF48051 		mov	r1, #4096
 397 000e 2846     		mov	r0, r5
 398              	.LVL21:
 399 0010 FFF7FEFF 		bl	HAL_GPIO_WritePin
 400              	.LVL22:
 288:Src/spi.c     ****   ret = reg|SETTING ;
 401              		.loc 1 288 0
 402 0014 64F07F04 		orn	r4, r4, #127
 403 0018 02A9     		add	r1, sp, #8
 404 001a 01F8014D 		strb	r4, [r1, #-1]!
 289:Src/spi.c     ****   HAL_SPI_Transmit(&hspi2,&ret,1,100);
 405              		.loc 1 289 0
 406 001e 0C4C     		ldr	r4, .L31+4
 407 0020 6423     		movs	r3, #100
 408 0022 0122     		movs	r2, #1
 409 0024 2046     		mov	r0, r4
 410 0026 FFF7FEFF 		bl	HAL_SPI_Transmit
 411              	.LVL23:
 290:Src/spi.c     ****   HAL_SPI_Receive(&hspi2,&val,1,100);
 412              		.loc 1 290 0
 413 002a 6423     		movs	r3, #100
 414 002c 0122     		movs	r2, #1
 415 002e 0DF10601 		add	r1, sp, #6
 416 0032 2046     		mov	r0, r4
 417 0034 FFF7FEFF 		bl	HAL_SPI_Receive
 418              	.LVL24:
 291:Src/spi.c     ****   HAL_GPIO_WritePin(gyro_cs_GPIO_Port,gyro_cs_Pin,GPIO_PIN_SET);
 419              		.loc 1 291 0
 420 0038 0122     		movs	r2, #1
 421 003a 4FF48051 		mov	r1, #4096
 422 003e 2846     		mov	r0, r5
 423 0040 FFF7FEFF 		bl	HAL_GPIO_WritePin
 424              	.LVL25:
 292:Src/spi.c     ****   return val;
 293:Src/spi.c     **** }
 425              		.loc 1 293 0
 426 0044 9DF80600 		ldrb	r0, [sp, #6]	@ zero_extendqisi2
 427 0048 03B0     		add	sp, sp, #12
 428              	.LCFI9:
 429              		.cfi_def_cfa_offset 12
 430              		@ sp needed
 431 004a 30BD     		pop	{r4, r5, pc}
 432              	.L32:
 433              		.align	2
 434              	.L31:
 435 004c 00040240 		.word	1073873920
 436 0050 00000000 		.word	hspi2
 437              		.cfi_endproc
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 14


 438              	.LFE130:
 440              		.section	.text.read_shift_byte,"ax",%progbits
 441              		.align	1
 442              		.global	read_shift_byte
 443              		.syntax unified
 444              		.thumb
 445              		.thumb_func
 446              		.fpu fpv4-sp-d16
 448              	read_shift_byte:
 449              	.LFB131:
 294:Src/spi.c     **** 
 295:Src/spi.c     **** 
 296:Src/spi.c     **** /****************************************************************
 297:Src/spi.c     ****  * Overview : shift 8bit and spi read register
 298:Src/spi.c     ****  * Argument : register
 299:Src/spi.c     ****  * Return : 2byte data (shift 8bit)
 300:Src/spi.c     ****  ************************************************************/
 301:Src/spi.c     **** int16_t read_shift_byte(uint8_t reg){
 450              		.loc 1 301 0
 451              		.cfi_startproc
 452              		@ args = 0, pretend = 0, frame = 8
 453              		@ frame_needed = 0, uses_anonymous_args = 0
 454              	.LVL26:
 455 0000 30B5     		push	{r4, r5, lr}
 456              	.LCFI10:
 457              		.cfi_def_cfa_offset 12
 458              		.cfi_offset 4, -12
 459              		.cfi_offset 5, -8
 460              		.cfi_offset 14, -4
 461 0002 83B0     		sub	sp, sp, #12
 462              	.LCFI11:
 463              		.cfi_def_cfa_offset 24
 464 0004 0446     		mov	r4, r0
 302:Src/spi.c     ****   uint8_t address,val_1;
 303:Src/spi.c     ****   int16_t val_2;
 304:Src/spi.c     ****   HAL_GPIO_WritePin(gyro_cs_GPIO_Port,gyro_cs_Pin,GPIO_PIN_RESET);
 465              		.loc 1 304 0
 466 0006 134D     		ldr	r5, .L35
 467 0008 0022     		movs	r2, #0
 468 000a 4FF48051 		mov	r1, #4096
 469 000e 2846     		mov	r0, r5
 470              	.LVL27:
 471 0010 FFF7FEFF 		bl	HAL_GPIO_WritePin
 472              	.LVL28:
 305:Src/spi.c     ****   address = reg | SETTING ;
 473              		.loc 1 305 0
 474 0014 64F07F04 		orn	r4, r4, #127
 475 0018 02A9     		add	r1, sp, #8
 476 001a 01F8014D 		strb	r4, [r1, #-1]!
 306:Src/spi.c     ****   HAL_SPI_Transmit(&hspi2,&address,1,100);
 477              		.loc 1 306 0
 478 001e 0E4C     		ldr	r4, .L35+4
 479 0020 6423     		movs	r3, #100
 480 0022 0122     		movs	r2, #1
 481 0024 2046     		mov	r0, r4
 482 0026 FFF7FEFF 		bl	HAL_SPI_Transmit
 483              	.LVL29:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 15


 307:Src/spi.c     ****   HAL_SPI_Receive(&hspi2,&val_1,1,100);
 484              		.loc 1 307 0
 485 002a 6423     		movs	r3, #100
 486 002c 0122     		movs	r2, #1
 487 002e 0DF10601 		add	r1, sp, #6
 488 0032 2046     		mov	r0, r4
 489 0034 FFF7FEFF 		bl	HAL_SPI_Receive
 490              	.LVL30:
 308:Src/spi.c     ****   val_2 = (int16_t)(val_1 << 8);
 491              		.loc 1 308 0
 492 0038 9DF80640 		ldrb	r4, [sp, #6]	@ zero_extendqisi2
 493 003c 2402     		lsls	r4, r4, #8
 494 003e 24B2     		sxth	r4, r4
 495              	.LVL31:
 309:Src/spi.c     ****   HAL_GPIO_WritePin(gyro_cs_GPIO_Port,gyro_cs_Pin,GPIO_PIN_SET);
 496              		.loc 1 309 0
 497 0040 0122     		movs	r2, #1
 498 0042 4FF48051 		mov	r1, #4096
 499 0046 2846     		mov	r0, r5
 500 0048 FFF7FEFF 		bl	HAL_GPIO_WritePin
 501              	.LVL32:
 310:Src/spi.c     ****   return val_2;
 311:Src/spi.c     **** }
 502              		.loc 1 311 0
 503 004c 2046     		mov	r0, r4
 504 004e 03B0     		add	sp, sp, #12
 505              	.LCFI12:
 506              		.cfi_def_cfa_offset 12
 507              		@ sp needed
 508 0050 30BD     		pop	{r4, r5, pc}
 509              	.LVL33:
 510              	.L36:
 511 0052 00BF     		.align	2
 512              	.L35:
 513 0054 00040240 		.word	1073873920
 514 0058 00000000 		.word	hspi2
 515              		.cfi_endproc
 516              	.LFE131:
 518              		.section	.text.write_byte,"ax",%progbits
 519              		.align	1
 520              		.global	write_byte
 521              		.syntax unified
 522              		.thumb
 523              		.thumb_func
 524              		.fpu fpv4-sp-d16
 526              	write_byte:
 527              	.LFB132:
 312:Src/spi.c     **** 
 313:Src/spi.c     **** 
 314:Src/spi.c     **** /**************************************************************
 315:Src/spi.c     ****  * Overview : spi write 1byte
 316:Src/spi.c     ****  * Argument : register
 317:Src/spi.c     ****  * Return : 
 318:Src/spi.c     ****  *************************************************************/
 319:Src/spi.c     **** void write_byte( uint8_t reg,uint8_t val){
 528              		.loc 1 319 0
 529              		.cfi_startproc
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 16


 530              		@ args = 0, pretend = 0, frame = 16
 531              		@ frame_needed = 0, uses_anonymous_args = 0
 532              	.LVL34:
 533 0000 70B5     		push	{r4, r5, r6, lr}
 534              	.LCFI13:
 535              		.cfi_def_cfa_offset 16
 536              		.cfi_offset 4, -16
 537              		.cfi_offset 5, -12
 538              		.cfi_offset 6, -8
 539              		.cfi_offset 14, -4
 540 0002 84B0     		sub	sp, sp, #16
 541              	.LCFI14:
 542              		.cfi_def_cfa_offset 32
 543 0004 8DF80710 		strb	r1, [sp, #7]
 320:Src/spi.c     ****   uint8_t ret;
 321:Src/spi.c     ****   ret = reg & 0x7F;
 544              		.loc 1 321 0
 545 0008 00F07F00 		and	r0, r0, #127
 546              	.LVL35:
 547 000c 04AC     		add	r4, sp, #16
 548 000e 04F8010D 		strb	r0, [r4, #-1]!
 322:Src/spi.c     ****   HAL_GPIO_WritePin(gyro_cs_GPIO_Port,gyro_cs_Pin,GPIO_PIN_RESET);
 549              		.loc 1 322 0
 550 0012 0E4D     		ldr	r5, .L39
 551 0014 0022     		movs	r2, #0
 552 0016 4FF48051 		mov	r1, #4096
 553              	.LVL36:
 554 001a 2846     		mov	r0, r5
 555 001c FFF7FEFF 		bl	HAL_GPIO_WritePin
 556              	.LVL37:
 323:Src/spi.c     ****   HAL_SPI_Transmit(&hspi2,&ret,1,100);
 557              		.loc 1 323 0
 558 0020 0B4E     		ldr	r6, .L39+4
 559 0022 6423     		movs	r3, #100
 560 0024 0122     		movs	r2, #1
 561 0026 2146     		mov	r1, r4
 562 0028 3046     		mov	r0, r6
 563 002a FFF7FEFF 		bl	HAL_SPI_Transmit
 564              	.LVL38:
 324:Src/spi.c     ****   HAL_SPI_Transmit(&hspi2,&val,1,100);
 565              		.loc 1 324 0
 566 002e 6423     		movs	r3, #100
 567 0030 0122     		movs	r2, #1
 568 0032 0DF10701 		add	r1, sp, #7
 569 0036 3046     		mov	r0, r6
 570 0038 FFF7FEFF 		bl	HAL_SPI_Transmit
 571              	.LVL39:
 325:Src/spi.c     ****   HAL_GPIO_WritePin(gyro_cs_GPIO_Port,gyro_cs_Pin,GPIO_PIN_SET);
 572              		.loc 1 325 0
 573 003c 0122     		movs	r2, #1
 574 003e 4FF48051 		mov	r1, #4096
 575 0042 2846     		mov	r0, r5
 576 0044 FFF7FEFF 		bl	HAL_GPIO_WritePin
 577              	.LVL40:
 326:Src/spi.c     **** }
 578              		.loc 1 326 0
 579 0048 04B0     		add	sp, sp, #16
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 17


 580              	.LCFI15:
 581              		.cfi_def_cfa_offset 16
 582              		@ sp needed
 583 004a 70BD     		pop	{r4, r5, r6, pc}
 584              	.L40:
 585              		.align	2
 586              	.L39:
 587 004c 00040240 		.word	1073873920
 588 0050 00000000 		.word	hspi2
 589              		.cfi_endproc
 590              	.LFE132:
 592              		.section	.text.MPU6500_init,"ax",%progbits
 593              		.align	1
 594              		.global	MPU6500_init
 595              		.syntax unified
 596              		.thumb
 597              		.thumb_func
 598              		.fpu fpv4-sp-d16
 600              	MPU6500_init:
 601              	.LFB133:
 327:Src/spi.c     **** 
 328:Src/spi.c     **** 
 329:Src/spi.c     **** ///////////////////////////////////////////////////////////////////////
 330:Src/spi.c     **** // set up mpu-6500
 331:Src/spi.c     **** // [argument] nothing
 332:Src/spi.c     **** // [Substitutiong] nothing
 333:Src/spi.c     **** // [return] nothong
 334:Src/spi.c     **** ///////////////////////////////////////////////////////////////////////
 335:Src/spi.c     **** void MPU6500_init( void )
 336:Src/spi.c     **** {
 602              		.loc 1 336 0
 603              		.cfi_startproc
 604              		@ args = 0, pretend = 0, frame = 0
 605              		@ frame_needed = 0, uses_anonymous_args = 0
 606 0000 10B5     		push	{r4, lr}
 607              	.LCFI16:
 608              		.cfi_def_cfa_offset 8
 609              		.cfi_offset 4, -8
 610              		.cfi_offset 14, -4
 337:Src/spi.c     ****   uint8_t who_am_i;
 338:Src/spi.c     ****   uint8_t recheck_who_am_i;
 339:Src/spi.c     ****   
 340:Src/spi.c     ****   HAL_Delay( 100 );
 611              		.loc 1 340 0
 612 0002 6420     		movs	r0, #100
 613 0004 FFF7FEFF 		bl	HAL_Delay
 614              	.LVL41:
 341:Src/spi.c     ****   who_am_i = read_byte( MPU6500_RA_WHO_AM_I );
 615              		.loc 1 341 0
 616 0008 7520     		movs	r0, #117
 617 000a FFF7FEFF 		bl	read_byte
 618              	.LVL42:
 619 000e 0446     		mov	r4, r0
 620              	.LVL43:
 342:Src/spi.c     ****   printf( "\r\n0x%x\r\n",who_am_i );
 621              		.loc 1 342 0
 622 0010 0146     		mov	r1, r0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 18


 623 0012 1B48     		ldr	r0, .L46
 624              	.LVL44:
 625 0014 FFF7FEFF 		bl	printf
 626              	.LVL45:
 343:Src/spi.c     **** 
 344:Src/spi.c     ****   if ( who_am_i != 0x70 ){
 627              		.loc 1 344 0
 628 0018 702C     		cmp	r4, #112
 629 001a 10D0     		beq	.L42
 345:Src/spi.c     ****     HAL_Delay( 300 );
 630              		.loc 1 345 0
 631 001c 4FF49670 		mov	r0, #300
 632 0020 FFF7FEFF 		bl	HAL_Delay
 633              	.LVL46:
 346:Src/spi.c     ****     recheck_who_am_i = read_byte( MPU6500_RA_WHO_AM_I );
 634              		.loc 1 346 0
 635 0024 7520     		movs	r0, #117
 636 0026 FFF7FEFF 		bl	read_byte
 637              	.LVL47:
 638 002a 0146     		mov	r1, r0
 639              	.LVL48:
 347:Src/spi.c     ****     if ( recheck_who_am_i != 0x70 ){
 640              		.loc 1 347 0
 641 002c 7028     		cmp	r0, #112
 642 002e 03D0     		beq	.L43
 643              	.LVL49:
 644              	.L44:
 348:Src/spi.c     ****       while(1){
 349:Src/spi.c     ****         printf( "gyro_error\r");
 645              		.loc 1 349 0 discriminator 1
 646 0030 1448     		ldr	r0, .L46+4
 647 0032 FFF7FEFF 		bl	printf
 648              	.LVL50:
 649 0036 FBE7     		b	.L44
 650              	.LVL51:
 651              	.L43:
 350:Src/spi.c     ****       }
 351:Src/spi.c     ****     } else {
 352:Src/spi.c     ****       printf( "recheck_who_am_i = 0x%x\r\n", recheck_who_am_i );
 652              		.loc 1 352 0
 653 0038 1348     		ldr	r0, .L46+8
 654              	.LVL52:
 655 003a FFF7FEFF 		bl	printf
 656              	.LVL53:
 657              	.L42:
 353:Src/spi.c     ****     }
 354:Src/spi.c     ****   }
 355:Src/spi.c     **** 
 356:Src/spi.c     ****   HAL_Delay( 50 );
 658              		.loc 1 356 0
 659 003e 3220     		movs	r0, #50
 660 0040 FFF7FEFF 		bl	HAL_Delay
 661              	.LVL54:
 357:Src/spi.c     **** 
 358:Src/spi.c     ****   // solve sleep 
 359:Src/spi.c     ****   write_byte( MPU6500_RA_PWR_MGMT_1, 0x00 );
 662              		.loc 1 359 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 19


 663 0044 0021     		movs	r1, #0
 664 0046 6B20     		movs	r0, #107
 665 0048 FFF7FEFF 		bl	write_byte
 666              	.LVL55:
 360:Src/spi.c     **** 
 361:Src/spi.c     ****   HAL_Delay( 50 );
 667              		.loc 1 361 0
 668 004c 3220     		movs	r0, #50
 669 004e FFF7FEFF 		bl	HAL_Delay
 670              	.LVL56:
 362:Src/spi.c     **** 
 363:Src/spi.c     **** 	// DLPF_CFG = 0 : Gyro's LPF is not avaiable
 364:Src/spi.c     **** 	// not avaiable FIFO
 365:Src/spi.c     ****   write_byte( MPU6500_RA_CONFIG, 0x00 );
 671              		.loc 1 365 0
 672 0052 0021     		movs	r1, #0
 673 0054 1A20     		movs	r0, #26
 674 0056 FFF7FEFF 		bl	write_byte
 675              	.LVL57:
 366:Src/spi.c     **** 
 367:Src/spi.c     ****   HAL_Delay( 50 );
 676              		.loc 1 367 0
 677 005a 3220     		movs	r0, #50
 678 005c FFF7FEFF 		bl	HAL_Delay
 679              	.LVL58:
 368:Src/spi.c     **** 
 369:Src/spi.c     ****   // Gyro scope is full scale
 370:Src/spi.c     **** 	write_byte(MPU6500_RA_GYRO_CONFIG, 0x18 );
 680              		.loc 1 370 0
 681 0060 1821     		movs	r1, #24
 682 0062 1B20     		movs	r0, #27
 683 0064 FFF7FEFF 		bl	write_byte
 684              	.LVL59:
 371:Src/spi.c     ****   HAL_Delay( 50 );
 685              		.loc 1 371 0
 686 0068 3220     		movs	r0, #50
 687 006a FFF7FEFF 		bl	HAL_Delay
 688              	.LVL60:
 372:Src/spi.c     **** 
 373:Src/spi.c     ****   // Accel scope is full scale
 374:Src/spi.c     ****   write_byte( MPU6500_RA_ACCEL_CONFIG, 0x18 );
 689              		.loc 1 374 0
 690 006e 1821     		movs	r1, #24
 691 0070 1C20     		movs	r0, #28
 692 0072 FFF7FEFF 		bl	write_byte
 693              	.LVL61:
 375:Src/spi.c     **** 
 376:Src/spi.c     ****   gyro_calc_flag = 1;
 694              		.loc 1 376 0
 695 0076 054B     		ldr	r3, .L46+12
 696 0078 0122     		movs	r2, #1
 697 007a 1A70     		strb	r2, [r3]
 377:Src/spi.c     **** 
 378:Src/spi.c     **** }
 698              		.loc 1 378 0
 699 007c 10BD     		pop	{r4, pc}
 700              	.L47:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 20


 701 007e 00BF     		.align	2
 702              	.L46:
 703 0080 00000000 		.word	.LC1
 704 0084 0C000000 		.word	.LC2
 705 0088 18000000 		.word	.LC3
 706 008c 00000000 		.word	.LANCHOR0
 707              		.cfi_endproc
 708              	.LFE133:
 710              		.section	.text.MPU6500_read_gyro_z,"ax",%progbits
 711              		.align	1
 712              		.global	MPU6500_read_gyro_z
 713              		.syntax unified
 714              		.thumb
 715              		.thumb_func
 716              		.fpu fpv4-sp-d16
 718              	MPU6500_read_gyro_z:
 719              	.LFB134:
 379:Src/spi.c     **** 
 380:Src/spi.c     **** ///////////////////////////////////////////////////////////////////////
 381:Src/spi.c     **** // get mpu-6500 read z axis data
 382:Src/spi.c     **** // [argument] nothing
 383:Src/spi.c     **** // [Substitutiong] nothing
 384:Src/spi.c     **** // [return] read z ( rad / sec)
 385:Src/spi.c     **** ///////////////////////////////////////////////////////////////////////
 386:Src/spi.c     **** float MPU6500_read_gyro_z( void )
 387:Src/spi.c     **** {
 720              		.loc 1 387 0
 721              		.cfi_startproc
 722              		@ args = 0, pretend = 0, frame = 0
 723              		@ frame_needed = 0, uses_anonymous_args = 0
 724 0000 10B5     		push	{r4, lr}
 725              	.LCFI17:
 726              		.cfi_def_cfa_offset 8
 727              		.cfi_offset 4, -8
 728              		.cfi_offset 14, -4
 388:Src/spi.c     ****   int16_t gyro_z;
 389:Src/spi.c     ****   float omega;
 390:Src/spi.c     **** 
 391:Src/spi.c     ****   gyro_z = (int16_t)( read_shift_byte(MPU6500_RA_GYRO_ZOUT_H) | read_byte(MPU6500_RA_GYRO_ZOUT_L) )
 729              		.loc 1 391 0
 730 0002 4720     		movs	r0, #71
 731 0004 FFF7FEFF 		bl	read_shift_byte
 732              	.LVL62:
 733 0008 0446     		mov	r4, r0
 734 000a 4820     		movs	r0, #72
 735 000c FFF7FEFF 		bl	read_byte
 736              	.LVL63:
 737 0010 00B2     		sxth	r0, r0
 738 0012 0443     		orrs	r4, r4, r0
 739 0014 24B2     		sxth	r4, r4
 740              	.LVL64:
 392:Src/spi.c     **** 
 393:Src/spi.c     ****   // GYRO FACTOR 
 394:Src/spi.c     ****   // 180 * PI ( rad/sec )
 395:Src/spi.c     ****   
 396:Src/spi.c     ****   omega = (float)( ( gyro_z - gyro_z_offset ) / GYRO_FACTOR);
 741              		.loc 1 396 0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 21


 742 0016 07EE904A 		vmov	s15, r4	@ int
 743 001a F8EEE77A 		vcvt.f32.s32	s15, s15
 744 001e 054B     		ldr	r3, .L50
 745 0020 93ED000A 		vldr.32	s0, [r3]
 746 0024 77EEC07A 		vsub.f32	s15, s15, s0
 747              	.LVL65:
 397:Src/spi.c     **** 
 398:Src/spi.c     ****   return omega;
 399:Src/spi.c     **** }
 748              		.loc 1 399 0
 749 0028 9FED030A 		vldr.32	s0, .L50+4
 750 002c 87EE800A 		vdiv.f32	s0, s15, s0
 751              	.LVL66:
 752 0030 10BD     		pop	{r4, pc}
 753              	.LVL67:
 754              	.L51:
 755 0032 00BF     		.align	2
 756              	.L50:
 757 0034 00000000 		.word	.LANCHOR1
 758 0038 33338341 		.word	1099117363
 759              		.cfi_endproc
 760              	.LFE134:
 762              		.section	.text.MPU6500_z_axis_offset_calc_start,"ax",%progbits
 763              		.align	1
 764              		.global	MPU6500_z_axis_offset_calc_start
 765              		.syntax unified
 766              		.thumb
 767              		.thumb_func
 768              		.fpu fpv4-sp-d16
 770              	MPU6500_z_axis_offset_calc_start:
 771              	.LFB135:
 400:Src/spi.c     **** ///////////////////////////////////////////////////////////////////////
 401:Src/spi.c     **** // get mpu-6500 read z axis offset start
 402:Src/spi.c     **** // [argument] nothing
 403:Src/spi.c     **** // [Substitutiong] nothing
 404:Src/spi.c     **** // [return] read z ( rad / sec)
 405:Src/spi.c     **** ///////////////////////////////////////////////////////////////////////
 406:Src/spi.c     **** void MPU6500_z_axis_offset_calc_start( void )
 407:Src/spi.c     **** {
 772              		.loc 1 407 0
 773              		.cfi_startproc
 774              		@ args = 0, pretend = 0, frame = 0
 775              		@ frame_needed = 0, uses_anonymous_args = 0
 776              		@ link register save eliminated.
 408:Src/spi.c     ****   gyro_z_offset = 0.0f;
 777              		.loc 1 408 0
 778 0000 0023     		movs	r3, #0
 779 0002 054A     		ldr	r2, .L53
 780 0004 1360     		str	r3, [r2]	@ float
 409:Src/spi.c     ****   gyro_offset_cnt = 0; 
 781              		.loc 1 409 0
 782 0006 0022     		movs	r2, #0
 783 0008 0449     		ldr	r1, .L53+4
 784 000a 0A80     		strh	r2, [r1]	@ movhi
 410:Src/spi.c     ****   gyro_calc_flag = 0;
 785              		.loc 1 410 0
 786 000c 0449     		ldr	r1, .L53+8
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 22


 787 000e 0A70     		strb	r2, [r1]
 411:Src/spi.c     ****   rotation_real.distance=0;
 788              		.loc 1 411 0
 789 0010 044A     		ldr	r2, .L53+12
 790 0012 D360     		str	r3, [r2, #12]	@ float
 412:Src/spi.c     **** }
 791              		.loc 1 412 0
 792 0014 7047     		bx	lr
 793              	.L54:
 794 0016 00BF     		.align	2
 795              	.L53:
 796 0018 00000000 		.word	.LANCHOR1
 797 001c 00000000 		.word	.LANCHOR2
 798 0020 00000000 		.word	.LANCHOR0
 799 0024 00000000 		.word	rotation_real
 800              		.cfi_endproc
 801              	.LFE135:
 803              		.section	.text.MPU6500_z_axis_offset_calc,"ax",%progbits
 804              		.align	1
 805              		.global	MPU6500_z_axis_offset_calc
 806              		.syntax unified
 807              		.thumb
 808              		.thumb_func
 809              		.fpu fpv4-sp-d16
 811              	MPU6500_z_axis_offset_calc:
 812              	.LFB136:
 413:Src/spi.c     **** 
 414:Src/spi.c     **** ///////////////////////////////////////////////////////////////////////
 415:Src/spi.c     **** // get mpu-6500 read z axis offset calc
 416:Src/spi.c     **** // [argument] nothing
 417:Src/spi.c     **** // [Substitutiong] nothing
 418:Src/spi.c     **** // [return] read z ( rad / sec)
 419:Src/spi.c     **** ///////////////////////////////////////////////////////////////////////
 420:Src/spi.c     **** void MPU6500_z_axis_offset_calc( void )
 421:Src/spi.c     **** {
 813              		.loc 1 421 0
 814              		.cfi_startproc
 815              		@ args = 0, pretend = 0, frame = 0
 816              		@ frame_needed = 0, uses_anonymous_args = 0
 817 0000 10B5     		push	{r4, lr}
 818              	.LCFI18:
 819              		.cfi_def_cfa_offset 8
 820              		.cfi_offset 4, -8
 821              		.cfi_offset 14, -4
 422:Src/spi.c     ****   int16_t gyro_z;
 423:Src/spi.c     **** 
 424:Src/spi.c     ****   gyro_z = (int16_t)( read_shift_byte(MPU6500_RA_GYRO_ZOUT_H) | read_byte(MPU6500_RA_GYRO_ZOUT_L) )
 822              		.loc 1 424 0
 823 0002 4720     		movs	r0, #71
 824 0004 FFF7FEFF 		bl	read_shift_byte
 825              	.LVL68:
 826 0008 0446     		mov	r4, r0
 827 000a 4820     		movs	r0, #72
 828 000c FFF7FEFF 		bl	read_byte
 829              	.LVL69:
 830 0010 00B2     		sxth	r0, r0
 831 0012 0443     		orrs	r4, r4, r0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 23


 832              	.LVL70:
 425:Src/spi.c     **** 
 426:Src/spi.c     ****   // GYRO FACTOR ( deg / sec )
 427:Src/spi.c     **** 
 428:Src/spi.c     ****   if ( gyro_offset_cnt < 1023 ){
 833              		.loc 1 428 0
 834 0014 114B     		ldr	r3, .L60
 835 0016 B3F90030 		ldrsh	r3, [r3]
 836 001a 40F2FE32 		movw	r2, #1022
 837 001e 9342     		cmp	r3, r2
 838 0020 0CDD     		ble	.L59
 429:Src/spi.c     ****     gyro_z_offset += (float)gyro_z;
 430:Src/spi.c     ****     gyro_offset_cnt++;
 431:Src/spi.c     ****   } else {
 432:Src/spi.c     ****     gyro_z_offset /= 1023.0f;
 839              		.loc 1 432 0
 840 0022 0F4B     		ldr	r3, .L60+4
 841 0024 D3ED006A 		vldr.32	s13, [r3]
 842 0028 9FED0E7A 		vldr.32	s14, .L60+8
 843 002c C6EE877A 		vdiv.f32	s15, s13, s14
 844 0030 C3ED007A 		vstr.32	s15, [r3]
 433:Src/spi.c     ****     //gyro_z_offset = roundf( gyro_z_offset );
 434:Src/spi.c     ****     gyro_calc_flag = 1;
 845              		.loc 1 434 0
 846 0034 0C4B     		ldr	r3, .L60+12
 847 0036 0122     		movs	r2, #1
 848 0038 1A70     		strb	r2, [r3]
 849              	.LVL71:
 850              	.L55:
 435:Src/spi.c     ****   }
 436:Src/spi.c     **** }
 851              		.loc 1 436 0
 852 003a 10BD     		pop	{r4, pc}
 853              	.LVL72:
 854              	.L59:
 855 003c 24B2     		sxth	r4, r4
 429:Src/spi.c     ****     gyro_offset_cnt++;
 856              		.loc 1 429 0
 857 003e 07EE904A 		vmov	s15, r4	@ int
 858 0042 F8EEE77A 		vcvt.f32.s32	s15, s15
 859 0046 064A     		ldr	r2, .L60+4
 860 0048 92ED007A 		vldr.32	s14, [r2]
 861 004c 77EE277A 		vadd.f32	s15, s14, s15
 862 0050 C2ED007A 		vstr.32	s15, [r2]
 430:Src/spi.c     ****   } else {
 863              		.loc 1 430 0
 864 0054 0133     		adds	r3, r3, #1
 865 0056 014A     		ldr	r2, .L60
 866 0058 1380     		strh	r3, [r2]	@ movhi
 867 005a EEE7     		b	.L55
 868              	.L61:
 869              		.align	2
 870              	.L60:
 871 005c 00000000 		.word	.LANCHOR2
 872 0060 00000000 		.word	.LANCHOR1
 873 0064 00C07F44 		.word	1149222912
 874 0068 00000000 		.word	.LANCHOR0
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 24


 875              		.cfi_endproc
 876              	.LFE136:
 878              		.section	.text.MPU6500_calc_check,"ax",%progbits
 879              		.align	1
 880              		.global	MPU6500_calc_check
 881              		.syntax unified
 882              		.thumb
 883              		.thumb_func
 884              		.fpu fpv4-sp-d16
 886              	MPU6500_calc_check:
 887              	.LFB137:
 437:Src/spi.c     **** 
 438:Src/spi.c     **** int8_t MPU6500_calc_check( void )
 439:Src/spi.c     **** {
 888              		.loc 1 439 0
 889              		.cfi_startproc
 890              		@ args = 0, pretend = 0, frame = 0
 891              		@ frame_needed = 0, uses_anonymous_args = 0
 892              		@ link register save eliminated.
 440:Src/spi.c     ****   return gyro_calc_flag;
 441:Src/spi.c     **** }
 893              		.loc 1 441 0
 894 0000 014B     		ldr	r3, .L63
 895 0002 93F90000 		ldrsb	r0, [r3]
 896 0006 7047     		bx	lr
 897              	.L64:
 898              		.align	2
 899              	.L63:
 900 0008 00000000 		.word	.LANCHOR0
 901              		.cfi_endproc
 902              	.LFE137:
 904              		.section	.text.checkGyroOffset,"ax",%progbits
 905              		.align	1
 906              		.global	checkGyroOffset
 907              		.syntax unified
 908              		.thumb
 909              		.thumb_func
 910              		.fpu fpv4-sp-d16
 912              	checkGyroOffset:
 913              	.LFB138:
 442:Src/spi.c     **** 
 443:Src/spi.c     **** // debug ON
 444:Src/spi.c     **** float checkGyroOffset()
 445:Src/spi.c     **** {
 914              		.loc 1 445 0
 915              		.cfi_startproc
 916              		@ args = 0, pretend = 0, frame = 0
 917              		@ frame_needed = 0, uses_anonymous_args = 0
 918              		@ link register save eliminated.
 446:Src/spi.c     ****   return gyro_z_offset;
 447:Src/spi.c     **** }
 919              		.loc 1 447 0
 920 0000 014B     		ldr	r3, .L66
 921 0002 93ED000A 		vldr.32	s0, [r3]
 922 0006 7047     		bx	lr
 923              	.L67:
 924              		.align	2
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 25


 925              	.L66:
 926 0008 00000000 		.word	.LANCHOR1
 927              		.cfi_endproc
 928              	.LFE138:
 930              		.section	.text.MPU6500_read_accel_x,"ax",%progbits
 931              		.align	1
 932              		.global	MPU6500_read_accel_x
 933              		.syntax unified
 934              		.thumb
 935              		.thumb_func
 936              		.fpu fpv4-sp-d16
 938              	MPU6500_read_accel_x:
 939              	.LFB139:
 448:Src/spi.c     **** 
 449:Src/spi.c     **** ///////////////////////////////////////////////////////////////////////
 450:Src/spi.c     **** // get mpu-6500 read x axis accel
 451:Src/spi.c     **** // [argument] nothing
 452:Src/spi.c     **** // [Substitutiong] nothing
 453:Src/spi.c     **** // [return] read x ( m / sec^2)
 454:Src/spi.c     **** ///////////////////////////////////////////////////////////////////////
 455:Src/spi.c     **** float MPU6500_read_accel_x( void )
 456:Src/spi.c     **** {
 940              		.loc 1 456 0
 941              		.cfi_startproc
 942              		@ args = 0, pretend = 0, frame = 0
 943              		@ frame_needed = 0, uses_anonymous_args = 0
 944 0000 10B5     		push	{r4, lr}
 945              	.LCFI19:
 946              		.cfi_def_cfa_offset 8
 947              		.cfi_offset 4, -8
 948              		.cfi_offset 14, -4
 457:Src/spi.c     ****   int16_t accel_x;
 458:Src/spi.c     ****   float accel;
 459:Src/spi.c     **** 
 460:Src/spi.c     ****   accel_x = (int16_t)( read_shift_byte(MPU6500_RA_ACCEL_XOUT_H) | read_byte(MPU6500_RA_ACCEL_XOUT_L
 949              		.loc 1 460 0
 950 0002 3B20     		movs	r0, #59
 951 0004 FFF7FEFF 		bl	read_shift_byte
 952              	.LVL73:
 953 0008 0446     		mov	r4, r0
 954 000a 3C20     		movs	r0, #60
 955 000c FFF7FEFF 		bl	read_byte
 956              	.LVL74:
 957 0010 00B2     		sxth	r0, r0
 958 0012 0443     		orrs	r4, r4, r0
 959 0014 24B2     		sxth	r4, r4
 960              	.LVL75:
 461:Src/spi.c     **** 
 462:Src/spi.c     ****   // GYRO FACTOR 
 463:Src/spi.c     ****   
 464:Src/spi.c     ****   accel = (float)( accel_x / ACCEL_FACTOR);
 961              		.loc 1 464 0
 962 0016 07EE904A 		vmov	s15, r4	@ int
 963 001a B8EEE70A 		vcvt.f32.s32	s0, s15
 964              	.LVL76:
 465:Src/spi.c     **** 
 466:Src/spi.c     ****   return accel;
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 26


 467:Src/spi.c     **** }
 965              		.loc 1 467 0
 966 001e DFED027A 		vldr.32	s15, .L70
 967 0022 20EE270A 		vmul.f32	s0, s0, s15
 968              	.LVL77:
 969 0026 10BD     		pop	{r4, pc}
 970              	.LVL78:
 971              	.L71:
 972              		.align	2
 973              	.L70:
 974 0028 0000003A 		.word	973078528
 975              		.cfi_endproc
 976              	.LFE139:
 978              		.section	.text.UpdataGyro,"ax",%progbits
 979              		.align	1
 980              		.global	UpdataGyro
 981              		.syntax unified
 982              		.thumb
 983              		.thumb_func
 984              		.fpu fpv4-sp-d16
 986              	UpdataGyro:
 987              	.LFB140:
 468:Src/spi.c     **** 
 469:Src/spi.c     **** void UpdataGyro(void){
 988              		.loc 1 469 0
 989              		.cfi_startproc
 990              		@ args = 0, pretend = 0, frame = 0
 991              		@ frame_needed = 0, uses_anonymous_args = 0
 992 0000 08B5     		push	{r3, lr}
 993              	.LCFI20:
 994              		.cfi_def_cfa_offset 8
 995              		.cfi_offset 3, -8
 996              		.cfi_offset 14, -4
 470:Src/spi.c     ****   if(gyro_calc_flag){
 997              		.loc 1 470 0
 998 0002 0B4B     		ldr	r3, .L77
 999 0004 93F90030 		ldrsb	r3, [r3]
 1000 0008 13B9     		cbnz	r3, .L76
 471:Src/spi.c     ****     rotation_real.velocity = MPU6500_read_gyro_z();
 472:Src/spi.c     ****     rotation_real.distance += rotation_real.velocity/1000.0f;
 473:Src/spi.c     ****   }else{
 474:Src/spi.c     ****     MPU6500_z_axis_offset_calc();
 1001              		.loc 1 474 0
 1002 000a FFF7FEFF 		bl	MPU6500_z_axis_offset_calc
 1003              	.LVL79:
 1004              	.L72:
 475:Src/spi.c     ****   }
 476:Src/spi.c     **** }
 1005              		.loc 1 476 0
 1006 000e 08BD     		pop	{r3, pc}
 1007              	.L76:
 471:Src/spi.c     ****     rotation_real.velocity = MPU6500_read_gyro_z();
 1008              		.loc 1 471 0
 1009 0010 FFF7FEFF 		bl	MPU6500_read_gyro_z
 1010              	.LVL80:
 1011 0014 074B     		ldr	r3, .L77+4
 1012 0016 83ED010A 		vstr.32	s0, [r3, #4]
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 27


 472:Src/spi.c     ****   }else{
 1013              		.loc 1 472 0
 1014 001a DFED077A 		vldr.32	s15, .L77+8
 1015 001e 80EE277A 		vdiv.f32	s14, s0, s15
 1016 0022 D3ED037A 		vldr.32	s15, [r3, #12]
 1017 0026 77EE877A 		vadd.f32	s15, s15, s14
 1018 002a C3ED037A 		vstr.32	s15, [r3, #12]
 1019 002e EEE7     		b	.L72
 1020              	.L78:
 1021              		.align	2
 1022              	.L77:
 1023 0030 00000000 		.word	.LANCHOR0
 1024 0034 00000000 		.word	rotation_real
 1025 0038 00007A44 		.word	1148846080
 1026              		.cfi_endproc
 1027              	.LFE140:
 1029              		.section	.text.parity,"ax",%progbits
 1030              		.align	1
 1031              		.global	parity
 1032              		.syntax unified
 1033              		.thumb
 1034              		.thumb_func
 1035              		.fpu fpv4-sp-d16
 1037              	parity:
 1038              	.LFB141:
 477:Src/spi.c     **** 
 478:Src/spi.c     **** uint16_t parity(uint16_t val) {
 1039              		.loc 1 478 0
 1040              		.cfi_startproc
 1041              		@ args = 0, pretend = 0, frame = 0
 1042              		@ frame_needed = 0, uses_anonymous_args = 0
 1043              		@ link register save eliminated.
 1044              	.LVL81:
 479:Src/spi.c     **** 	val ^= val >> 8;
 1045              		.loc 1 479 0
 1046 0000 80EA1020 		eor	r0, r0, r0, lsr #8
 1047              	.LVL82:
 480:Src/spi.c     **** 	val ^= val >> 4;
 1048              		.loc 1 480 0
 1049 0004 80EA1010 		eor	r0, r0, r0, lsr #4
 1050              	.LVL83:
 481:Src/spi.c     **** 	val ^= val >> 2;
 1051              		.loc 1 481 0
 1052 0008 80EA9000 		eor	r0, r0, r0, lsr #2
 1053              	.LVL84:
 482:Src/spi.c     **** 	val ^= val >> 1;
 1054              		.loc 1 482 0
 1055 000c 80EA5000 		eor	r0, r0, r0, lsr #1
 1056              	.LVL85:
 483:Src/spi.c     **** 
 484:Src/spi.c     **** 	return val & 0x0001;
 485:Src/spi.c     **** }
 1057              		.loc 1 485 0
 1058 0010 00F00100 		and	r0, r0, #1
 1059              	.LVL86:
 1060 0014 7047     		bx	lr
 1061              		.cfi_endproc
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 28


 1062              	.LFE141:
 1064              		.section	.text.enc_read_byte,"ax",%progbits
 1065              		.align	1
 1066              		.global	enc_read_byte
 1067              		.syntax unified
 1068              		.thumb
 1069              		.thumb_func
 1070              		.fpu fpv4-sp-d16
 1072              	enc_read_byte:
 1073              	.LFB142:
 486:Src/spi.c     **** 
 487:Src/spi.c     **** /********************************************************************
 488:Src/spi.c     ****  * Overview : spi read register
 489:Src/spi.c     ****  * Argument : register
 490:Src/spi.c     ****  * Return : 2byte data
 491:Src/spi.c     **** ********************************************************************/
 492:Src/spi.c     **** uint16_t enc_read_byte(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin, uint16_t reg){
 1074              		.loc 1 492 0
 1075              		.cfi_startproc
 1076              		@ args = 0, pretend = 0, frame = 8
 1077              		@ frame_needed = 0, uses_anonymous_args = 0
 1078              	.LVL87:
 1079 0000 70B5     		push	{r4, r5, r6, lr}
 1080              	.LCFI21:
 1081              		.cfi_def_cfa_offset 16
 1082              		.cfi_offset 4, -16
 1083              		.cfi_offset 5, -12
 1084              		.cfi_offset 6, -8
 1085              		.cfi_offset 14, -4
 1086 0002 82B0     		sub	sp, sp, #8
 1087              	.LCFI22:
 1088              		.cfi_def_cfa_offset 24
 1089 0004 0546     		mov	r5, r0
 1090 0006 0E46     		mov	r6, r1
 493:Src/spi.c     ****   uint16_t out;
 494:Src/spi.c     ****   uint8_t val[2]={0x00,0x00};
 1091              		.loc 1 494 0
 1092 0008 0023     		movs	r3, #0
 1093 000a 8DF80430 		strb	r3, [sp, #4]
 1094 000e 8DF80530 		strb	r3, [sp, #5]
 495:Src/spi.c     ****   uint8_t ret[2]={reg>>8,reg&0xff};
 1095              		.loc 1 495 0
 1096 0012 140A     		lsrs	r4, r2, #8
 1097 0014 8DF80040 		strb	r4, [sp]
 1098 0018 8DF80120 		strb	r2, [sp, #1]
 496:Src/spi.c     **** 
 497:Src/spi.c     ****   HAL_GPIO_WritePin(GPIOx,GPIO_Pin,GPIO_PIN_RESET);
 1099              		.loc 1 497 0
 1100 001c 1A46     		mov	r2, r3
 1101              	.LVL88:
 1102 001e FFF7FEFF 		bl	HAL_GPIO_WritePin
 1103              	.LVL89:
 498:Src/spi.c     ****   ret[0] |= 0x40;//write
 1104              		.loc 1 498 0
 1105 0022 9DF80040 		ldrb	r4, [sp]	@ zero_extendqisi2
 1106 0026 44F04004 		orr	r4, r4, #64
 499:Src/spi.c     ****   ret[0] |= parity(ret[0]<<8|ret[1])<<7;//parity
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 29


 1107              		.loc 1 499 0
 1108 002a 9DF80100 		ldrb	r0, [sp, #1]	@ zero_extendqisi2
 1109 002e 40EA0420 		orr	r0, r0, r4, lsl #8
 1110 0032 FFF7FEFF 		bl	parity
 1111              	.LVL90:
 1112 0036 44EAC010 		orr	r0, r4, r0, lsl #7
 1113 003a 02A9     		add	r1, sp, #8
 1114 003c 01F8080D 		strb	r0, [r1, #-8]!
 500:Src/spi.c     ****   HAL_SPI_Transmit(&hspi1,ret,1,1000);
 1115              		.loc 1 500 0
 1116 0040 0D4C     		ldr	r4, .L82
 1117 0042 4FF47A73 		mov	r3, #1000
 1118 0046 0122     		movs	r2, #1
 1119 0048 2046     		mov	r0, r4
 1120 004a FFF7FEFF 		bl	HAL_SPI_Transmit
 1121              	.LVL91:
 501:Src/spi.c     ****   HAL_SPI_Receive(&hspi1,val,1,1000);
 1122              		.loc 1 501 0
 1123 004e 4FF47A73 		mov	r3, #1000
 1124 0052 0122     		movs	r2, #1
 1125 0054 01A9     		add	r1, sp, #4
 1126 0056 2046     		mov	r0, r4
 1127 0058 FFF7FEFF 		bl	HAL_SPI_Receive
 1128              	.LVL92:
 502:Src/spi.c     ****   HAL_GPIO_WritePin(GPIOx,GPIO_Pin,GPIO_PIN_SET);
 1129              		.loc 1 502 0
 1130 005c 0122     		movs	r2, #1
 1131 005e 3146     		mov	r1, r6
 1132 0060 2846     		mov	r0, r5
 1133 0062 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1134              	.LVL93:
 503:Src/spi.c     ****   out=(uint16_t)((val[0]<<8)|val[1]);
 1135              		.loc 1 503 0
 1136 0066 9DF80400 		ldrb	r0, [sp, #4]	@ zero_extendqisi2
 1137 006a 9DF80530 		ldrb	r3, [sp, #5]	@ zero_extendqisi2
 1138              	.LVL94:
 504:Src/spi.c     ****   return out;
 505:Src/spi.c     **** }
 1139              		.loc 1 505 0
 1140 006e 43EA0020 		orr	r0, r3, r0, lsl #8
 1141              	.LVL95:
 1142 0072 02B0     		add	sp, sp, #8
 1143              	.LCFI23:
 1144              		.cfi_def_cfa_offset 16
 1145              		@ sp needed
 1146 0074 70BD     		pop	{r4, r5, r6, pc}
 1147              	.LVL96:
 1148              	.L83:
 1149 0076 00BF     		.align	2
 1150              	.L82:
 1151 0078 00000000 		.word	hspi1
 1152              		.cfi_endproc
 1153              	.LFE142:
 1155              		.section	.text.enc_write_byte,"ax",%progbits
 1156              		.align	1
 1157              		.global	enc_write_byte
 1158              		.syntax unified
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 30


 1159              		.thumb
 1160              		.thumb_func
 1161              		.fpu fpv4-sp-d16
 1163              	enc_write_byte:
 1164              	.LFB143:
 506:Src/spi.c     **** 
 507:Src/spi.c     **** /********************************************************************
 508:Src/spi.c     ****  * Overview : spi write register
 509:Src/spi.c     ****  * Argument : register
 510:Src/spi.c     ****  * Return : 2byte data
 511:Src/spi.c     **** ********************************************************************/
 512:Src/spi.c     **** void enc_write_byte(GPIO_TypeDef* GPIOx, uint16_t GPIO_Pin, uint16_t reg, uint16_t value){
 1165              		.loc 1 512 0
 1166              		.cfi_startproc
 1167              		@ args = 0, pretend = 0, frame = 8
 1168              		@ frame_needed = 0, uses_anonymous_args = 0
 1169              	.LVL97:
 1170 0000 70B5     		push	{r4, r5, r6, lr}
 1171              	.LCFI24:
 1172              		.cfi_def_cfa_offset 16
 1173              		.cfi_offset 4, -16
 1174              		.cfi_offset 5, -12
 1175              		.cfi_offset 6, -8
 1176              		.cfi_offset 14, -4
 1177 0002 82B0     		sub	sp, sp, #8
 1178              	.LCFI25:
 1179              		.cfi_def_cfa_offset 24
 1180 0004 0546     		mov	r5, r0
 1181 0006 0E46     		mov	r6, r1
 513:Src/spi.c     ****   uint8_t val[2]={value>>8,value&0xff};
 1182              		.loc 1 513 0
 1183 0008 1C0A     		lsrs	r4, r3, #8
 1184 000a 8DF80440 		strb	r4, [sp, #4]
 1185 000e 8DF80530 		strb	r3, [sp, #5]
 514:Src/spi.c     ****   uint8_t ret[2]={reg>>8,reg&0xff};
 1186              		.loc 1 514 0
 1187 0012 130A     		lsrs	r3, r2, #8
 1188              	.LVL98:
 1189 0014 8DF80030 		strb	r3, [sp]
 1190 0018 8DF80120 		strb	r2, [sp, #1]
 515:Src/spi.c     **** 
 516:Src/spi.c     ****   HAL_GPIO_WritePin(GPIOx,GPIO_Pin,GPIO_PIN_RESET);
 1191              		.loc 1 516 0
 1192 001c 0022     		movs	r2, #0
 1193              	.LVL99:
 1194 001e FFF7FEFF 		bl	HAL_GPIO_WritePin
 1195              	.LVL100:
 517:Src/spi.c     ****   ret[0] |= parity(ret[0]<<8|ret[1])<<7;//parity
 1196              		.loc 1 517 0
 1197 0022 9DF80040 		ldrb	r4, [sp]	@ zero_extendqisi2
 1198 0026 9DF80100 		ldrb	r0, [sp, #1]	@ zero_extendqisi2
 1199 002a 40EA0420 		orr	r0, r0, r4, lsl #8
 1200 002e FFF7FEFF 		bl	parity
 1201              	.LVL101:
 1202 0032 44EAC010 		orr	r0, r4, r0, lsl #7
 1203 0036 8DF80000 		strb	r0, [sp]
 518:Src/spi.c     ****   val[0] |= parity(val[0]<<8|val[1])<<7;//parity
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 31


 1204              		.loc 1 518 0
 1205 003a 9DF80440 		ldrb	r4, [sp, #4]	@ zero_extendqisi2
 1206 003e 9DF80500 		ldrb	r0, [sp, #5]	@ zero_extendqisi2
 1207 0042 40EA0420 		orr	r0, r0, r4, lsl #8
 1208 0046 FFF7FEFF 		bl	parity
 1209              	.LVL102:
 1210 004a 44EAC010 		orr	r0, r4, r0, lsl #7
 1211 004e 8DF80400 		strb	r0, [sp, #4]
 519:Src/spi.c     ****   HAL_SPI_Transmit(&hspi1,ret,1,1000);
 1212              		.loc 1 519 0
 1213 0052 0B4C     		ldr	r4, .L86
 1214 0054 4FF47A73 		mov	r3, #1000
 1215 0058 0122     		movs	r2, #1
 1216 005a 6946     		mov	r1, sp
 1217 005c 2046     		mov	r0, r4
 1218 005e FFF7FEFF 		bl	HAL_SPI_Transmit
 1219              	.LVL103:
 520:Src/spi.c     ****   HAL_SPI_Transmit(&hspi1,val,1,1000);
 1220              		.loc 1 520 0
 1221 0062 4FF47A73 		mov	r3, #1000
 1222 0066 0122     		movs	r2, #1
 1223 0068 01A9     		add	r1, sp, #4
 1224 006a 2046     		mov	r0, r4
 1225 006c FFF7FEFF 		bl	HAL_SPI_Transmit
 1226              	.LVL104:
 521:Src/spi.c     ****   HAL_GPIO_WritePin(GPIOx,GPIO_Pin,GPIO_PIN_SET);
 1227              		.loc 1 521 0
 1228 0070 0122     		movs	r2, #1
 1229 0072 3146     		mov	r1, r6
 1230 0074 2846     		mov	r0, r5
 1231 0076 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1232              	.LVL105:
 522:Src/spi.c     **** }
 1233              		.loc 1 522 0
 1234 007a 02B0     		add	sp, sp, #8
 1235              	.LCFI26:
 1236              		.cfi_def_cfa_offset 16
 1237              		@ sp needed
 1238 007c 70BD     		pop	{r4, r5, r6, pc}
 1239              	.LVL106:
 1240              	.L87:
 1241 007e 00BF     		.align	2
 1242              	.L86:
 1243 0080 00000000 		.word	hspi1
 1244              		.cfi_endproc
 1245              	.LFE143:
 1247              		.section	.text.set_enc,"ax",%progbits
 1248              		.align	1
 1249              		.global	set_enc
 1250              		.syntax unified
 1251              		.thumb
 1252              		.thumb_func
 1253              		.fpu fpv4-sp-d16
 1255              	set_enc:
 1256              	.LFB144:
 523:Src/spi.c     **** 
 524:Src/spi.c     **** void set_enc(void){
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 32


 1257              		.loc 1 524 0
 1258              		.cfi_startproc
 1259              		@ args = 0, pretend = 0, frame = 0
 1260              		@ frame_needed = 0, uses_anonymous_args = 0
 1261 0000 10B5     		push	{r4, lr}
 1262              	.LCFI27:
 1263              		.cfi_def_cfa_offset 8
 1264              		.cfi_offset 4, -8
 1265              		.cfi_offset 14, -4
 525:Src/spi.c     ****   enc_write_byte(csr_GPIO_Port,csr_Pin,ZPOSM,0x88);//ZPOSM[0:7]
 1266              		.loc 1 525 0
 1267 0002 264C     		ldr	r4, .L90
 1268 0004 8823     		movs	r3, #136
 1269 0006 1622     		movs	r2, #22
 1270 0008 0121     		movs	r1, #1
 1271 000a 2046     		mov	r0, r4
 1272 000c FFF7FEFF 		bl	enc_write_byte
 1273              	.LVL107:
 526:Src/spi.c     ****   HAL_Delay(100);
 1274              		.loc 1 526 0
 1275 0010 6420     		movs	r0, #100
 1276 0012 FFF7FEFF 		bl	HAL_Delay
 1277              	.LVL108:
 527:Src/spi.c     ****   enc_write_byte(csr_GPIO_Port,csr_Pin,ZPOSL,0b00011111);//comp_h_error_en[7]|comp_l_error_en[6]|ZP
 1278              		.loc 1 527 0
 1279 0016 1F23     		movs	r3, #31
 1280 0018 1722     		movs	r2, #23
 1281 001a 0121     		movs	r1, #1
 1282 001c 2046     		mov	r0, r4
 1283 001e FFF7FEFF 		bl	enc_write_byte
 1284              	.LVL109:
 528:Src/spi.c     ****   HAL_Delay(100);
 1285              		.loc 1 528 0
 1286 0022 6420     		movs	r0, #100
 1287 0024 FFF7FEFF 		bl	HAL_Delay
 1288              	.LVL110:
 529:Src/spi.c     ****   enc_write_byte(csr_GPIO_Port,csr_Pin,SETTINGS1,0b00000111);
 1289              		.loc 1 529 0
 1290 0028 0723     		movs	r3, #7
 1291 002a 1822     		movs	r2, #24
 1292 002c 0121     		movs	r1, #1
 1293 002e 2046     		mov	r0, r4
 1294 0030 FFF7FEFF 		bl	enc_write_byte
 1295              	.LVL111:
 530:Src/spi.c     ****   HAL_Delay(100);
 1296              		.loc 1 530 0
 1297 0034 6420     		movs	r0, #100
 1298 0036 FFF7FEFF 		bl	HAL_Delay
 1299              	.LVL112:
 531:Src/spi.c     ****   enc_write_byte(csr_GPIO_Port,csr_Pin,SETTINGS2,0b00000000);
 1300              		.loc 1 531 0
 1301 003a 0023     		movs	r3, #0
 1302 003c 1922     		movs	r2, #25
 1303 003e 0121     		movs	r1, #1
 1304 0040 2046     		mov	r0, r4
 1305 0042 FFF7FEFF 		bl	enc_write_byte
 1306              	.LVL113:
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 33


 532:Src/spi.c     ****   HAL_Delay(100);
 1307              		.loc 1 532 0
 1308 0046 6420     		movs	r0, #100
 1309 0048 FFF7FEFF 		bl	HAL_Delay
 1310              	.LVL114:
 533:Src/spi.c     **** 
 534:Src/spi.c     ****   enc_write_byte(csl_GPIO_Port,csl_Pin,ZPOSM,0x88);//ZPOSM[0:7]
 1311              		.loc 1 534 0
 1312 004c 04F58064 		add	r4, r4, #1024
 1313 0050 8823     		movs	r3, #136
 1314 0052 1622     		movs	r2, #22
 1315 0054 0121     		movs	r1, #1
 1316 0056 2046     		mov	r0, r4
 1317 0058 FFF7FEFF 		bl	enc_write_byte
 1318              	.LVL115:
 535:Src/spi.c     ****   HAL_Delay(100);
 1319              		.loc 1 535 0
 1320 005c 6420     		movs	r0, #100
 1321 005e FFF7FEFF 		bl	HAL_Delay
 1322              	.LVL116:
 536:Src/spi.c     ****   enc_write_byte(csl_GPIO_Port,csl_Pin,ZPOSL,0b00011111);//comp_h_error_en[7]|comp_l_error_en[6]|ZP
 1323              		.loc 1 536 0
 1324 0062 1F23     		movs	r3, #31
 1325 0064 1722     		movs	r2, #23
 1326 0066 0121     		movs	r1, #1
 1327 0068 2046     		mov	r0, r4
 1328 006a FFF7FEFF 		bl	enc_write_byte
 1329              	.LVL117:
 537:Src/spi.c     ****   HAL_Delay(100);
 1330              		.loc 1 537 0
 1331 006e 6420     		movs	r0, #100
 1332 0070 FFF7FEFF 		bl	HAL_Delay
 1333              	.LVL118:
 538:Src/spi.c     ****   enc_write_byte(csl_GPIO_Port,csl_Pin,SETTINGS1,0b00000111);
 1334              		.loc 1 538 0
 1335 0074 0723     		movs	r3, #7
 1336 0076 1822     		movs	r2, #24
 1337 0078 0121     		movs	r1, #1
 1338 007a 2046     		mov	r0, r4
 1339 007c FFF7FEFF 		bl	enc_write_byte
 1340              	.LVL119:
 539:Src/spi.c     ****   HAL_Delay(100);
 1341              		.loc 1 539 0
 1342 0080 6420     		movs	r0, #100
 1343 0082 FFF7FEFF 		bl	HAL_Delay
 1344              	.LVL120:
 540:Src/spi.c     ****   enc_write_byte(csl_GPIO_Port,csl_Pin,SETTINGS2,0b00000000);
 1345              		.loc 1 540 0
 1346 0086 0023     		movs	r3, #0
 1347 0088 1922     		movs	r2, #25
 1348 008a 0121     		movs	r1, #1
 1349 008c 2046     		mov	r0, r4
 1350 008e FFF7FEFF 		bl	enc_write_byte
 1351              	.LVL121:
 541:Src/spi.c     ****   HAL_Delay(100);
 1352              		.loc 1 541 0
 1353 0092 6420     		movs	r0, #100
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 34


 1354 0094 FFF7FEFF 		bl	HAL_Delay
 1355              	.LVL122:
 542:Src/spi.c     **** }
 1356              		.loc 1 542 0
 1357 0098 10BD     		pop	{r4, pc}
 1358              	.L91:
 1359 009a 00BF     		.align	2
 1360              	.L90:
 1361 009c 00000240 		.word	1073872896
 1362              		.cfi_endproc
 1363              	.LFE144:
 1365              		.section	.text.get_enc_val,"ax",%progbits
 1366              		.align	1
 1367              		.global	get_enc_val
 1368              		.syntax unified
 1369              		.thumb
 1370              		.thumb_func
 1371              		.fpu fpv4-sp-d16
 1373              	get_enc_val:
 1374              	.LFB145:
 543:Src/spi.c     **** 
 544:Src/spi.c     **** void get_enc_val(void){
 1375              		.loc 1 544 0
 1376              		.cfi_startproc
 1377              		@ args = 0, pretend = 0, frame = 0
 1378              		@ frame_needed = 0, uses_anonymous_args = 0
 1379 0000 08B5     		push	{r3, lr}
 1380              	.LCFI28:
 1381              		.cfi_def_cfa_offset 8
 1382              		.cfi_offset 3, -8
 1383              		.cfi_offset 14, -4
 545:Src/spi.c     ****   enc_l = enc_read_byte(csl_GPIO_Port,csl_Pin,ANGLECOM);
 1384              		.loc 1 545 0
 1385 0002 43F6FF72 		movw	r2, #16383
 1386 0006 0121     		movs	r1, #1
 1387 0008 0648     		ldr	r0, .L94
 1388 000a FFF7FEFF 		bl	enc_read_byte
 1389              	.LVL123:
 1390 000e 064B     		ldr	r3, .L94+4
 1391 0010 1880     		strh	r0, [r3]	@ movhi
 546:Src/spi.c     ****   enc_r = enc_read_byte(csr_GPIO_Port,csr_Pin,ANGLECOM);
 1392              		.loc 1 546 0
 1393 0012 43F6FF72 		movw	r2, #16383
 1394 0016 0121     		movs	r1, #1
 1395 0018 0448     		ldr	r0, .L94+8
 1396 001a FFF7FEFF 		bl	enc_read_byte
 1397              	.LVL124:
 1398 001e 044B     		ldr	r3, .L94+12
 1399 0020 1880     		strh	r0, [r3]	@ movhi
 547:Src/spi.c     **** }
 1400              		.loc 1 547 0
 1401 0022 08BD     		pop	{r3, pc}
 1402              	.L95:
 1403              		.align	2
 1404              	.L94:
 1405 0024 00040240 		.word	1073873920
 1406 0028 00000000 		.word	enc_l
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 35


 1407 002c 00000240 		.word	1073872896
 1408 0030 00000000 		.word	enc_r
 1409              		.cfi_endproc
 1410              	.LFE145:
 1412              		.comm	hspi2,88,4
 1413              		.comm	hspi1,88,4
 1414              		.section	.bss.gyro_offset_cnt,"aw",%nobits
 1415              		.align	1
 1416              		.set	.LANCHOR2,. + 0
 1419              	gyro_offset_cnt:
 1420 0000 0000     		.space	2
 1421              		.section	.bss.gyro_z_offset,"aw",%nobits
 1422              		.align	2
 1423              		.set	.LANCHOR1,. + 0
 1426              	gyro_z_offset:
 1427 0000 00000000 		.space	4
 1428              		.section	.data.gyro_calc_flag,"aw",%progbits
 1429              		.set	.LANCHOR0,. + 0
 1432              	gyro_calc_flag:
 1433 0000 01       		.byte	1
 1434              		.section	.rodata.MPU6500_init.str1.4,"aMS",%progbits,1
 1435              		.align	2
 1436              	.LC1:
 1437 0000 0D0A3078 		.ascii	"\015\0120x%x\015\012\000"
 1437      25780D0A 
 1437      00
 1438 0009 000000   		.space	3
 1439              	.LC2:
 1440 000c 6779726F 		.ascii	"gyro_error\015\000"
 1440      5F657272 
 1440      6F720D00 
 1441              	.LC3:
 1442 0018 72656368 		.ascii	"recheck_who_am_i = 0x%x\015\012\000"
 1442      65636B5F 
 1442      77686F5F 
 1442      616D5F69 
 1442      203D2030 
 1443              		.section	.rodata.MX_SPI1_Init.str1.4,"aMS",%progbits,1
 1444              		.align	2
 1445              	.LC0:
 1446 0000 5372632F 		.ascii	"Src/spi.c\000"
 1446      7370692E 
 1446      6300
 1447              		.text
 1448              	.Letext0:
 1449              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1450              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1451              		.file 4 "Drivers/CMSIS/Include/core_cm4.h"
 1452              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 1453              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f411xe.h"
 1454              		.file 7 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1455              		.file 8 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 1456              		.file 9 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\lib\\gcc\\arm-none-eabi
 1457              		.file 10 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
 1458              		.file 11 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 1459              		.file 12 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 1460              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 36


 1461              		.file 14 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_spi.h"
 1462              		.file 15 "Inc/spi.h"
 1463              		.file 16 "Inc/variable.h"
 1464              		.file 17 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 1465              		.file 18 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 37


DEFINED SYMBOLS
                            *ABS*:00000000 spi.c
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:18     .text.MX_SPI1_Init:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:25     .text.MX_SPI1_Init:00000000 MX_SPI1_Init
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:88     .text.MX_SPI1_Init:00000044 $d
                            *COM*:00000058 hspi1
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:95     .text.MX_SPI2_Init:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:102    .text.MX_SPI2_Init:00000000 MX_SPI2_Init
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:164    .text.MX_SPI2_Init:00000044 $d
                            *COM*:00000058 hspi2
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:171    .text.HAL_SPI_MspInit:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:178    .text.HAL_SPI_MspInit:00000000 HAL_SPI_MspInit
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:288    .text.HAL_SPI_MspInit:00000084 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:297    .text.HAL_SPI_MspDeInit:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:304    .text.HAL_SPI_MspDeInit:00000000 HAL_SPI_MspDeInit
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:361    .text.HAL_SPI_MspDeInit:00000040 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:369    .text.read_byte:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:376    .text.read_byte:00000000 read_byte
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:435    .text.read_byte:0000004c $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:441    .text.read_shift_byte:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:448    .text.read_shift_byte:00000000 read_shift_byte
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:513    .text.read_shift_byte:00000054 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:519    .text.write_byte:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:526    .text.write_byte:00000000 write_byte
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:587    .text.write_byte:0000004c $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:593    .text.MPU6500_init:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:600    .text.MPU6500_init:00000000 MPU6500_init
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:703    .text.MPU6500_init:00000080 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:711    .text.MPU6500_read_gyro_z:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:718    .text.MPU6500_read_gyro_z:00000000 MPU6500_read_gyro_z
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:757    .text.MPU6500_read_gyro_z:00000034 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:763    .text.MPU6500_z_axis_offset_calc_start:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:770    .text.MPU6500_z_axis_offset_calc_start:00000000 MPU6500_z_axis_offset_calc_start
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:796    .text.MPU6500_z_axis_offset_calc_start:00000018 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:804    .text.MPU6500_z_axis_offset_calc:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:811    .text.MPU6500_z_axis_offset_calc:00000000 MPU6500_z_axis_offset_calc
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:871    .text.MPU6500_z_axis_offset_calc:0000005c $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:879    .text.MPU6500_calc_check:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:886    .text.MPU6500_calc_check:00000000 MPU6500_calc_check
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:900    .text.MPU6500_calc_check:00000008 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:905    .text.checkGyroOffset:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:912    .text.checkGyroOffset:00000000 checkGyroOffset
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:926    .text.checkGyroOffset:00000008 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:931    .text.MPU6500_read_accel_x:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:938    .text.MPU6500_read_accel_x:00000000 MPU6500_read_accel_x
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:974    .text.MPU6500_read_accel_x:00000028 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:979    .text.UpdataGyro:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:986    .text.UpdataGyro:00000000 UpdataGyro
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1023   .text.UpdataGyro:00000030 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1030   .text.parity:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1037   .text.parity:00000000 parity
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1065   .text.enc_read_byte:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1072   .text.enc_read_byte:00000000 enc_read_byte
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1151   .text.enc_read_byte:00000078 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1156   .text.enc_write_byte:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1163   .text.enc_write_byte:00000000 enc_write_byte
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1243   .text.enc_write_byte:00000080 $d
ARM GAS  C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s 			page 38


C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1248   .text.set_enc:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1255   .text.set_enc:00000000 set_enc
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1361   .text.set_enc:0000009c $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1366   .text.get_enc_val:00000000 $t
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1373   .text.get_enc_val:00000000 get_enc_val
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1405   .text.get_enc_val:00000024 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1415   .bss.gyro_offset_cnt:00000000 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1419   .bss.gyro_offset_cnt:00000000 gyro_offset_cnt
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1422   .bss.gyro_z_offset:00000000 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1426   .bss.gyro_z_offset:00000000 gyro_z_offset
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1432   .data.gyro_calc_flag:00000000 gyro_calc_flag
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1435   .rodata.MPU6500_init.str1.4:00000000 $d
C:\Users\kotaro\AppData\Local\Temp\cc0oWxMh.s:1444   .rodata.MX_SPI1_Init.str1.4:00000000 $d

UNDEFINED SYMBOLS
HAL_SPI_Init
_Error_Handler
HAL_GPIO_Init
HAL_GPIO_DeInit
HAL_GPIO_WritePin
HAL_SPI_Transmit
HAL_SPI_Receive
HAL_Delay
printf
rotation_real
enc_l
enc_r
